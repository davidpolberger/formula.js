!function(r,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.formulajs=n():r.formulajs=n()}(this,function(){return function(r){function n(t){if(e[t])return e[t].exports;var o=e[t]={exports:{},id:t,loaded:!1};return r[t].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var e={};return n.m=r,n.c=e,n.p="",n(0)}(function(r){for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n))switch(typeof r[n]){case"function":break;case"object":r[n]=function(n){var e=n.slice(1),t=r[n[0]];return function(r,n,o){t.apply(this,[r,n,o].concat(e))}}(r[n]);break;default:r[n]=r[r[n]]}return r}([function(r,n,e){var t=[e(1),e(14),e(15),e(17),e(3),e(11),e(18),e(19),e(20),e(7),e(21),e(2),e(22),e(5)];for(var o in t){var a=t[o];for(var u in a)n[u]=n[u]||a[u]}},function(r,n,e){function t(r,n){if(n)for(var e in n)r[e]=n[e];return r}var o=e(2);n.BETADIST=o.BETA.DIST,n.BETAINV=o.BETA.INV,n.BINOMDIST=o.BINOM.DIST,n.CHIDIST=o.CHISQ.DIST,n.CHIINV=o.CHISQ.INV,n.CHITEST=o.CHISQ.TEST,n.CONFIDENCE=t(o.CONFIDENCE.NORM,o.CONFIDENCE),n.COVAR=o.COVARIANCE.P,n.CRITBINOM=o.BINOM.INV,n.EXPONDIST=o.EXPON.DIST,n.FDIST=o.F.DIST,n.FINV=o.F.INV,n.FTEST=o.F.TEST,n.GAMMADIST=o.GAMMA.DIST,n.GAMMAINV=o.GAMMA.INV,n.HYPGEOMDIST=o.HYPGEOM.DIST,n.LOGINV=o.LOGNORM.INV,n.LOGNORMDIST=o.LOGNORM.DIST,n.MODE=t(o.MODE.SNGL,o.MODE),n.NEGBINOMDIST=o.NEGBINOM.DIST,n.NORMDIST=o.NORM.DIST,n.NORMINV=o.NORM.INV,n.NORMSDIST=o.NORM.S.DIST,n.NORMSINV=o.NORM.S.INV,n.PERCENTILE=t(o.PERCENTILE.EXC,o.PERCENTILE),n.PERCENTRANK=t(o.PERCENTRANK.INC,o.PERCENTRANK),n.POISSON=t(o.POISSON.DIST,o.POISSON),n.QUARTILE=t(o.QUARTILE.INC,o.QUARTILE),n.RANK=t(o.RANK.EQ,o.RANK),n.STDEV=t(o.STDEV.S,o.STDEV),n.STDEVP=o.STDEV.P,n.TDIST=o.T.DIST,n.TINV=o.T.INV,n.TTEST=o.T.TEST,n.VAR=t(o.VAR.S,o.VAR),n.VARP=o.VAR.P,n.WEIBULL=t(o.WEIBULL.DIST,o.WEIBULL),n.ZTEST=o.Z.TEST},function(r,n,e){var t=e(3),o=e(11),a=e(13).jStat,u=e(4),i=e(5),f=e(8),s=e(6),c=2.5066282746310002;n.AVEDEV=function(){var r=u.parseNumbers(s.flatten(arguments));return 0===r.length?i.num:r instanceof Error?r:a.sum(a(r).subtract(a.mean(r)).abs()[0])/r.length},n.AVERAGE=function(){var r=u.parseNumbers(s.flatten(arguments));if(r instanceof Error)return r;if(0===r.length)return i.div0;for(var n=r.length,e=0,t=0,o=0;o<n;o++)e+=r[o],t+=1;return e/t},n.AVERAGEA=function(){var r=u.parseNumbersA(s.flatten(arguments));return n.AVERAGE(r)},n.AVERAGEIF=function(r,n,e){e=e||r,r=s.flatten(r);var t=u.parseNumbersX(r,s.flatten(e));if(t instanceof Error)throw t;r=t[0],e=t[1],null!==n&&void 0!==n||(n=0);for(var o=0,a=0,c=0;c<r.length;c++)f(r[c]+n)&&(a+=e[c],o++);return 0===o?i.div0:a/o},n.AVERAGEIFS=function(){for(var r=u.argsToArray(arguments),n=s.flatten(r.shift()),e=0,t=0,o=0;o<n.length;o++)if("number"==typeof n[o]){for(var a=!0,c=0;c<r.length;c+=2){if(r[c].length!==n.length)return i.value;var l=r[c+1];if(/[><=!]/.test(l)){var m=l.slice(1);l=isNaN(parseFloat(m))?l[0]+JSON.stringify(m):l[0]+m}else l=isNaN(parseFloat(l))?"="+JSON.stringify(l):"="+l;if(!f(JSON.stringify(r[c][o])+l)){a=!1;break}}a&&(e+=n[o],t++)}return 0===t?i.div0:e/t},n.BETA={},n.BETA.DIST=function(r,n,e,t,o,i){return"number"==typeof t&&void 0===i&&(i=o,o=t,t=!0),o=void 0===o?0:o,i=void 0===i?1:i,r=u.parseNumber(r),r instanceof Error?r:(n=u.parseNumber(n),n instanceof Error?n:(e=u.parseNumber(e),e instanceof Error?e:(t=u.parseBool(t),t instanceof Error?t:(o=u.parseNumber(o),o instanceof Error?o:(i=u.parseNumber(i),i instanceof Error?i:(r=(r-o)/(i-o),t?a.beta.cdf(r,n,e):a.beta.pdf(r,n,e)))))))},n.BETA.INV=function(r,n,e,t,o){return t=void 0===t?0:t,o=void 0===o?1:o,r=u.parseNumber(r),r instanceof Error?r:(n=u.parseNumber(n),n instanceof Error?n:(e=u.parseNumber(e),e instanceof Error?e:(t=u.parseNumber(t),t instanceof Error?t:(o=u.parseNumber(o),o instanceof Error?o:a.beta.inv(r,n,e)*(o-t)+t))))},n.BINOM={},n.BINOM.DIST=function(r,n,e,t){return r=u.parseNumber(r),r instanceof Error?r:(n=u.parseNumber(n),n instanceof Error?n:(e=u.parseNumber(e),e instanceof Error?e:(t=u.parseBool(t),t instanceof Error?t:r<0||r>n?i.num:e<0||e>1?i.num:t?a.binomial.cdf(r,n,e):a.binomial.pdf(r,n,e))))},n.BINOM.DIST.RANGE=function(r,n,e,o){if(o=void 0===o?e:o,r=u.parseNumber(r),r instanceof Error)return r;if(r<0)return i.num;if(n=u.parseNumber(n),n instanceof Error)return n;if(n<0||n>1)return i.num;if(e=u.parseNumber(e),e instanceof Error)return e;if(e<0||e>r)return i.num;if(o=u.parseNumber(o),o instanceof Error)return o;if(o<e||o>r)return i.num;for(var a=0,f=e;f<=o;f++)a+=t.COMBIN(r,f)*Math.pow(n,f)*Math.pow(1-n,r-f);return a},n.BINOM.INV=function(r,n,e){if(r=u.parseNumber(r),r instanceof Error)return r;if(r<0)return i.num;if(n=u.parseNumber(n),n instanceof Error)return n;if(n<0||n>1)return i.num;if(e=u.parseNumber(e),e instanceof Error)return e;if(e<0||e>1)return i.num;for(var t=0;t<=r;){if(a.binomial.cdf(t,r,n)>=e)return t;t++}},n.CHISQ={},n.CHISQ.DIST=function(r,n,e){return r=u.parseNumber(r),r instanceof Error?r:r<0?i.num:(n=u.parseNumber(n),n instanceof Error?n:n<1||n>Math.pow(10,10)?i.num:(e=u.parseBool(e),e instanceof Error?e:e?a.chisquare.cdf(r,n):a.chisquare.pdf(r,n)))},n.CHISQ.DIST.RT=function(){throw new Error("CHISQ.DIST.RT is not implemented")},n.CHISQ.INV=function(r,n){return r=u.parseNumber(r),r instanceof Error?r:r<0||r>1?i.num:(n=u.parseNumber(n),n instanceof Error?n:n<1||n>Math.pow(10,10)?i.num:a.chisquare.inv(r,n))},n.CHISQ.INV.RT=function(){throw new Error("CHISQ.INV.RT is not implemented")},n.CHISQ.TEST=function(){throw new Error("CHISQ.TEST is not implemented")},n.CONFIDENCE={},n.CONFIDENCE.NORM=function(r,n,e){return r=u.parseNumber(r),r instanceof Error?r:r<=0||r>=1?i.num:(n=u.parseNumber(n),n instanceof Error?n:n<=0?i.num:(e=u.parseNumber(e),e instanceof Error?e:e<1?i.num:a.normalci(1,r,n,e)[1]-1))},n.CONFIDENCE.T=function(r,n,e){return r=u.parseNumber(r),r instanceof Error?r:r<=0||r>=1?i.num:(n=u.parseNumber(n),n instanceof Error?n:n<=0?i.num:(e=u.parseNumber(e),e instanceof Error?e:1===e?i.div0:e<1?i.num:a.tci(1,r,n,e)[1]-1))},n.CORREL=function(r,n){var e=u.parseNumbersX(r,n);if(e instanceof Error)return e;var t=e[0],o=e[1];return 0===t.length||0===o.length?i.div0:a.corrcoeff(t,o)},n.COUNT=function(){var r=u.parseNumbers(s.flatten(arguments));return r.length},n.COUNTA=function(){for(var r=s.flatten(arguments),n=0,e=0;e<r.length;e++)null!==r[e]&&void 0!==r[e]&&n++;return n},n.COUNTBLANK=function(){for(var r=s.flatten(arguments),n=0,e=0;e<r.length;e++)void 0!==r[e]&&null!==r[e]&&""!==r[e]||n++;return n},n.COUNTIF=function(r,n){r=s.flatten(r),n=/[><=!]/.test(n)?n[0]+JSON.stringify(n.slice(1)):"="+JSON.stringify(n);for(var e=0,t=0;t<r.length;t++)f(JSON.stringify(r[t])+n)&&e++;return e},n.COUNTIFS=function(){for(var r=u.argsToArray(arguments),n=0,e=0;e<r.length;e+=2){var t=s.flatten(r[e]),o=r[e+1];if(/[><=!]/.test(o)){var a=o.slice(1);o=isNaN(parseFloat(a))?o[0]+JSON.stringify(a):o[0]+a}else o=isNaN(parseFloat(o))?"="+JSON.stringify(o):"="+o;for(var i=0;i<t.length;i++)f(JSON.stringify(t[i])+o)&&n++}return n},n.COVARIANCE={},n.COVARIANCE.P=function(r,n){var e=u.parseNumbersX(r,n);if(e instanceof Error)return e;var t=e[0],o=e[1];if(0===t.length||0===o.length)return i.div0;for(var f=a.mean(t),s=a.mean(o),c=0,l=t.length,m=0;m<l;m++)c+=(t[m]-f)*(o[m]-s);return c/l},n.COVARIANCE.S=function(r,n){var e=u.parseNumbersX(r,n);if(e instanceof Error)return e;var t=e[0],o=e[1];return 0===t.length||0===o.length?i.div0:a.covariance(t,o)},n.DEVSQ=function(){var r=u.parseNumbers(s.flatten(arguments));if(r instanceof Error)return r;for(var n=a.mean(r),e=0,t=0;t<r.length;t++)e+=Math.pow(r[t]-n,2);return e},n.EXPON={},n.EXPON.DIST=function(r,n,e){return r=u.parseNumber(r),r instanceof Error?r:r<0?i.num:(n=u.parseNumber(n),n instanceof Error?n:n<=0?i.num:(e=u.parseBool(e),e instanceof Error?e:e?a.exponential.cdf(r,n):a.exponential.pdf(r,n)))},n.F={},n.F.DIST=function(r,n,e,t){return r=u.parseNumber(r),r instanceof Error?r:r<0?i.num:(n=u.parseNumber(n),n instanceof Error?n:n<1?i.num:(e=u.parseNumber(e),e instanceof Error?e:e<1?i.num:(t=u.parseBool(t),t instanceof Error?t:t?a.centralF.pdf(r,n,e):a.centralF.cdf(r,n,e))))},n.F.DIST.RT=function(){throw new Error("F.DIST.RT is not implemented")},n.F.INV=function(r,n,e){return r=u.parseNumber(r),r instanceof Error?r:r<0||r>1?i.num:(n=u.parseNumber(n),n instanceof Error?n:n<1?i.num:(e=u.parseNumber(e),e instanceof Error?e:e<1?i.num:a.centralF.inv(r,n,e)))},n.F.INV.RT=function(){throw new Error("F.INV.RT is not implemented")},n.F.TEST=function(){throw new Error("F.TEST is not implemented")},n.FISHER=function(r){return r=u.parseNumber(r),r instanceof Error?r:r<=-1||r>=1?i.num:Math.log((1+r)/(1-r))/2},n.FISHERINV=function(r){if(r=u.parseNumber(r),r instanceof Error)return r;var n=Math.exp(2*r);return(n-1)/(n+1)},n.FORECAST=function(r,n,e){if(r=u.parseNumber(r),r instanceof Error)return r;var t=u.parseNumbersX(n,e);if(t instanceof Error)return t;if(n=t[0],e=t[1],0===n.length||1===e.length)return i.na;for(var o=a.mean(e),f=a.mean(n),s=e.length,c=0,l=0,m=0;m<s;m++)c+=(e[m]-o)*(n[m]-f),l+=Math.pow(e[m]-o,2);if(0===l)return i.div0;var p=c/l,h=f-p*o;return h+p*r},n.FREQUENCY=function(r,n){if(r=u.parseNumbers(s.flatten(r)),r instanceof Error)return r;if(0===r.length){for(var e=[],t=0;t<n.length+1;t++)e.push(0);return e}if(n=u.parseNumbers(s.flatten(n)),n instanceof Error)return n;if(0===n.length)return[0,r.length];for(var o=r.length,a=n.length,e=[],t=0;t<=a;t++){e[t]=0;for(var i=0;i<o;i++)0===t?r[i]<=n[0]&&(e[0]+=1):t<a?r[i]>n[t-1]&&r[i]<=n[t]&&(e[t]+=1):t===a&&r[i]>n[a-1]&&(e[a]+=1)}return e},n.GAMMA=function(r){return r=u.parseNumber(r),r instanceof Error?r:0===r?i.num:parseInt(r,10)===r&&r<0?i.num:a.gammafn(r)},n.GAMMA.DIST=function(r,n,e,t){return r=u.parseNumber(r),r instanceof Error?r:r<0?i.num:(n=u.parseNumber(n),n instanceof Error?n:n<=0?i.num:(e=u.parseNumber(e),e instanceof Error?e:e<=0?i.num:(void 0===t&&(t=!1),t=u.parseBool(t),t instanceof Error?t:t?a.gamma.cdf(r,n,e,!0):a.gamma.pdf(r,n,e,!1))))},n.GAMMA.INV=function(r,n,e){return r=u.parseNumber(r),r instanceof Error?r:r<0||r>1?i.num:(n=u.parseNumber(n),n instanceof Error?n:n<=0?i.num:(e=u.parseNumber(e),e instanceof Error?e:e<=0?i.num:a.gamma.inv(r,n,e)))},n.GAMMALN=function(r){return r=u.parseNumber(r),r instanceof Error?r:r<=0?i.num:a.gammaln(r)},n.GAMMALN.PRECISE=function(r){var e=n.GAMMA(r);return e instanceof Error?e:Math.log(e)},n.GAUSS=function(r){return r=u.parseNumber(r),r instanceof Error?r:a.normal.cdf(r,0,1)-.5},n.GEOMEAN=function(){var r=u.parseNumbers(s.flatten(arguments));if(r instanceof Error)return r;if(0===r.length)return i.num;for(var n=0;n<r.length;n++)if(r[n]<=0)return i.num;return a.geomean(r)},n.GROWTH=function(r,n,e,t){for(var o,a,f=[],o=0;o<r.length;o++){if(void 0===r[o]||null===r[o])return i.value;if(a=u.parseNumber(r[o]),a instanceof Error)return a;if(a<=0)return i.num;f.push(a)}if(r=f,void 0===n)for(n=[],o=1;o<=r.length;o++)n.push(o);if(r.length!==n.length)return i.ref;if(n=u.parseNumbers(n),n instanceof Error)return n;if(r.length!==n.length)return i.value;if(void 0===e)for(e=[],o=1;o<=r.length;o++)e.push(o);if(e=u.parseNumbers(e),e instanceof Error)return e;if(0===e.length)return i.value;if(void 0===t&&(t=!0),t=u.parseBool(t),t instanceof Error)return t;var s=r.length,c=0,l=0,m=0,p=0;for(o=0;o<s;o++){var h=n[o],a=Math.log(r[o]);c+=h,l+=a,m+=h*a,p+=h*h}c/=s,l/=s,m/=s,p/=s;var E,v;t?(E=(m-c*l)/(p-c*c),v=l-E*c):(E=m/p,v=0);var g=[];for(o=0;o<e.length;o++)g.push(Math.exp(v+E*e[o]));return g},n.HARMEAN=function(){var r=u.parseNumbers(s.flatten(arguments));if(r instanceof Error)return r;for(var n=r.length,e=0,t=0;t<n;t++){if(r[t]<=0)return i.num;e+=1/r[t]}return n/e},n.HYPGEOM={},n.HYPGEOM.DIST=function(r,n,e,o,a){function f(r,n,e,o){return t.COMBIN(e,r)*t.COMBIN(o-e,n-r)/t.COMBIN(o,n)}function s(r,n,e,t){for(var o=0,a=0;a<=r;a++)o+=f(a,n,e,t);return o}return r=u.parseNumber(r),r instanceof Error?r:r<0?i.num:(n=u.parseNumber(n),n instanceof Error?n:n<=0?i.num:(e=u.parseNumber(e),e instanceof Error?e:e<=0?i.num:r>Math.min(n,e)?i.num:(o=u.parseNumber(o),o instanceof Error?o:n>o?i.num:e>o?i.num:o<=0?i.num:r<Math.max(0,n-o+e)?i.num:(a=u.parseBool(a),a instanceof Error?a:a?s(r,n,e,o):f(r,n,e,o)))))},n.INTERCEPT=function(r,e){var t=u.parseNumbersX(r,e);return t instanceof Error?t:(parsed_known_y=t[0],parsed_known_x=t[1],0===parsed_known_y.length||0===parsed_known_x.length?i.na:n.FORECAST(0,parsed_known_y,parsed_known_x))},n.KURT=function(){var r=u.parseNumbers(s.flatten(arguments));if(r instanceof Error)return r;if(r.length<4)return i.div0;for(var n=a.mean(r),e=r.length,t=0,o=0;o<e;o++)t+=Math.pow(r[o]-n,4);var f=a.stdev(r,!0);return 0===f?i.div0:(t/=Math.pow(f,4),e*(e+1)/((e-1)*(e-2)*(e-3))*t-3*(e-1)*(e-1)/((e-2)*(e-3)))},n.LARGE=function(r,n){return r=u.parseNumbers(s.flatten(r)),r instanceof Error?r:0===r.length?i.num:(n=u.parseNumber(n),n instanceof Error?n:n<=0||n>r.length?i.num:r.sort(function(r,n){return n-r})[n-1])},n.LINEST=function(r,n){var e=u.parseNumbersX(r,n);if(e instanceof Error)return e;if(r=e[0],n=e[1],0===r.length||0===n.length)return i.na;for(var t=a.mean(r),o=a.mean(n),f=n.length,s=0,c=0,l=0;l<f;l++)s+=(n[l]-o)*(r[l]-t),c+=Math.pow(n[l]-o,2);var m=s/c,p=t-m*o;return[m,p]},n.LOGEST=function(){throw new Error("LOGEST is not implemented")},n.LOGNORM={},n.LOGNORM.DIST=function(r,n,e,t){return r=u.parseNumber(r),r instanceof Error?r:r<=0?i.num:(n=u.parseNumber(n),n instanceof Error?n:(e=u.parseNumber(e),e instanceof Error?e:e<=0?i.num:(t=u.parseBool(t),t instanceof Error?t:t?a.lognormal.cdf(r,n,e):a.lognormal.pdf(r,n,e))))},n.LOGNORM.INV=function(r,n,e){return r=u.parseNumber(r),r instanceof Error?r:r<=0||r>=1?i.num:(n=u.parseNumber(n),n instanceof Error?n:(e=u.parseNumber(e),e instanceof Error?e:e<=0?i.num:a.lognormal.inv(r,n,e)))},n.MAX=function(){var r=u.parseNumbers(s.flatten(arguments));return r instanceof Error?r:0===r.length?0:Math.max.apply(Math,r)},n.MAXA=function(){var r=u.parseNumbersA(s.flatten(arguments));return r instanceof Error?r:0===r.length?0:Math.max.apply(Math,r)},n.MEDIAN=function(){var r=u.parseNumbers(s.flatten(arguments));return r instanceof Error?r:a.median(r)},n.MIN=function(){var r=u.parseNumbers(s.flatten(arguments));return r instanceof Error?r:0===r.length?0:Math.min.apply(Math,r)},n.MINA=function(){var r=u.parseNumbersA(s.flatten(arguments));return r instanceof Error?r:0===r.length?0:Math.min.apply(Math,r)},n.MODE={},n.MODE.MULT=function(){var r=u.parseNumbers(s.flatten(arguments));if(r instanceof Error)return r;for(var n,e=r.length,t={},o=[],a=0,f=!0,c=0;c<e;c++)n=r[c],t[n]=t[n]?t[n]+1:1,t[n]>1&&(f=!1),t[n]>a&&(a=t[n],o=[]),t[n]===a&&(o[o.length]=n);return f?i.na:o},n.MODE.SNGL=function(){var r=u.parseNumbers(s.flatten(arguments));if(r instanceof Error)return r;var e=n.MODE.MULT(r);return e instanceof Error?e:e.sort(function(r,n){return r-n})[0]},n.NEGBINOM={},n.NEGBINOM.DIST=function(r,n,e,t){return r=u.parseNumber(r),r instanceof Error?r:(n=u.parseNumber(n),n instanceof Error?n:r<0||n<1?i.num:(e=u.parseNumber(e),e instanceof Error?e:e<0||e>1?i.num:(t=u.parseBool(t),t instanceof Error?t:t?a.negbin.cdf(r,n,e):a.negbin.pdf(r,n,e))))},n.NORM={},n.NORM.DIST=function(r,n,e,t){return r=u.parseNumber(r),r instanceof Error?r:(n=u.parseNumber(n),n instanceof Error?n:(e=u.parseNumber(e),e instanceof Error?e:e<=0?i.num:t?a.normal.cdf(r,n,e):a.normal.pdf(r,n,e)))},n.NORM.INV=function(r,n,e){return r=u.parseNumber(r),r instanceof Error?r:r<=0||r>=1?i.num:(n=u.parseNumber(n),n instanceof Error?n:(e=u.parseNumber(e),e instanceof Error?e:e<=0?i.num:a.normal.inv(r,n,e)))},n.NORM.S={},n.NORM.S.DIST=function(r,n){return r=u.parseNumber(r),r instanceof Error?i.value:(n=u.parseBool(n),n instanceof Error?n:n?a.normal.cdf(r,0,1):a.normal.pdf(r,0,1))},n.NORM.S.INV=function(r){return r=u.parseNumber(r),r instanceof Error?i.value:r<=0||r>=1?i.num:a.normal.inv(r,0,1)},n.PEARSON=function(r,n){var e=u.parseNumbersX(r,n);if(e instanceof Error)return e;if(r=e[0],n=e[1],0===r.length||0===n.length)return i.na;for(var t=a.mean(r),o=a.mean(n),f=r.length,s=0,c=0,l=0,m=0;m<f;m++)s+=(r[m]-t)*(n[m]-o),c+=Math.pow(r[m]-t,2),l+=Math.pow(n[m]-o,2);return s/Math.sqrt(c*l)},n.PERCENTILE={},n.PERCENTILE.EXC=function(r,n){if(r=u.parseNumbers(s.flatten(r)),r instanceof Error)return r;if(0===r.length)return i.num;if(n=u.parseNumber(n),n instanceof Error)return n;if(n<=0||n>=1)return i.num;r=r.sort(function(r,n){return r-n});var e=r.length;if(n<1/(e+1)||n>1-1/(e+1))return i.num;var t=n*(e+1)-1,o=Math.floor(t);return u.cleanFloat(t===o?r[t]:r[o]+(t-o)*(r[o+1]-r[o]))},n.PERCENTILE.INC=function(r,n){if(r=u.parseNumbers(s.flatten(r)),r instanceof Error)return r;if(0===r.length)return i.num;if(n=u.parseNumber(n),n instanceof Error)return n;if(n<=0||n>=1)return i.num;r=r.sort(function(r,n){return r-n});var e=r.length,t=n*(e-1),o=Math.floor(t);return u.cleanFloat(t===o?r[t]:r[o]+(t-o)*(r[o+1]-r[o]))},n.PERCENTRANK={},n.PERCENTRANK.EXC=function(r,n,e){if(e=void 0===e?3:e,r=u.parseNumbers(s.flatten(r)),r instanceof Error)return r;if(0===r.length)return i.num;if(n=u.parseNumber(n),n instanceof Error)return n;if(e=u.parseNumber(e),e instanceof Error)return e;if(e<1)return i.num;r=r.sort(function(r,n){return r-n});for(var t=s.uniq(r),o=r.length,a=t.length,f=Math.pow(10,e),c=0,l=!1,m=0;!l&&m<a;)n===t[m]?(c=(r.indexOf(t[m])+1)/(o+1),l=!0):n>=t[m]&&(n<t[m+1]||m===a-1)&&(c=(r.indexOf(t[m])+1+(n-t[m])/(t[m+1]-t[m]))/(o+1),l=!0),m++;return Math.floor(c*f)/f},n.PERCENTRANK.INC=function(r,n,e){if(e=void 0===e?3:e,r=u.parseNumbers(s.flatten(r)),r instanceof Error)return r;if(0===r.length)return i.num;if(n=u.parseNumber(n),n instanceof Error)return n;if(e=u.parseNumber(e),e instanceof Error)return e;if(e<1)return i.num;r=r.sort(function(r,n){return r-n});for(var t=s.uniq(r),o=r.length,a=t.length,f=Math.pow(10,e),c=0,l=!1,m=0;!l&&m<a;)n===t[m]?(c=r.indexOf(t[m])/(o-1),l=!0):n>=t[m]&&(n<t[m+1]||m===a-1)&&(c=(r.indexOf(t[m])+(n-t[m])/(t[m+1]-t[m]))/(o-1),l=!0),m++;return Math.floor(c*f)/f},n.PERMUT=function(r,n){return r=u.parseNumber(r),r instanceof Error?r:r<=0?i.num:(n=u.parseNumber(n),n instanceof Error?n:n<0?i.num:r<n?i.num:t.FACT(r)/t.FACT(r-n))},n.PERMUTATIONA=function(r,n){return r=u.parseNumber(r),r instanceof Error?r:r<0?i.num:(n=u.parseNumber(n),n instanceof Error?n:n<0?i.num:Math.pow(r,n))},n.PHI=function(r){return r=u.parseNumber(r),r instanceof Error?r:Math.exp(-.5*r*r)/c},n.POISSON={},n.POISSON.DIST=function(r,n,e){return r=u.parseNumber(r),r instanceof Error?r:r<0?i.num:(n=u.parseNumber(n),n instanceof Error?n:n<0?i.num:(e=u.parseBool(e),e instanceof Error?e:e?a.poisson.cdf(r,n):a.poisson.pdf(r,n)))},n.PROB=function(r,n,e,t){if(e=void 0===e?0:e,t=void 0===t?e:t,r=u.parseNumbers(s.flatten(r)),r instanceof Error)return r;if(n=u.parseNumbers(s.flatten(n)),n instanceof Error)return n;if(r.length!==n.length)return i.na;if(n.filter(function(r){return r<=0||r>1}).length>0)return i.num;if(1!==n.reduce(function(r,n){return r+n}))return i.num;if(e=u.parseNumber(e),e instanceof Error)return e;if(t=u.parseNumber(t),t instanceof Error)return t;if(e===t)return r.indexOf(e)>=0?n[r.indexOf(e)]:0;for(var o=r.sort(function(r,n){return r-n}),a=o.length,f=0,c=0;c<a;c++)o[c]>=e&&o[c]<=t&&(f+=n[r.indexOf(o[c])]);return f},n.QUARTILE={},n.QUARTILE.EXC=function(r,e){if(r=u.parseNumbers(s.flatten(r)),r instanceof Error)return r;if(0===r.length)return i.num;if(e=u.parseNumber(e),e instanceof Error)return e;switch(e=parseInt(e,10)){case 1:return n.PERCENTILE.EXC(r,.25);case 2:return n.PERCENTILE.EXC(r,.5);case 3:return n.PERCENTILE.EXC(r,.75);default:return i.num}},n.QUARTILE.INC=function(r,e){if(r=u.parseNumbers(s.flatten(r)),r instanceof Error)return r;if(0===r.length)return i.num;if(e=u.parseNumber(e),e instanceof Error)return e;switch(e=parseInt(e,10)){case 1:return n.PERCENTILE.INC(r,.25);case 2:return n.PERCENTILE.INC(r,.5);case 3:return n.PERCENTILE.INC(r,.75);default:return i.num}},n.RANK={},n.RANK.AVG=function(r,n,e){if(r=u.parseNumber(r),r instanceof Error)return r;if(n=u.parseNumbers(s.flatten(n)),n instanceof Error)return n;if(0===n.length)return i.na;if(n.indexOf(r)<0)return i.na;e=e||!1;var t=e?function(r,n){return r-n}:function(r,n){return n-r};n=n.sort(t);for(var o=n.length,a=0,f=0;f<o;f++)n[f]===r&&a++;return a>1?(2*n.indexOf(r)+a+1)/2:n.indexOf(r)+1},n.RANK.EQ=function(r,n,e){if(r=u.parseNumber(r),r instanceof Error)return r;if(n=u.parseNumbers(s.flatten(n)),n instanceof Error)return n;if(0===n.length)return i.na;if(n.indexOf(r)<0)return i.na;e=e||!1;var t=e?function(r,n){return r-n}:function(r,n){return n-r};return n=n.sort(t),n.indexOf(r)+1},n.RSQ=function(r,e){var t=u.parseNumbersX(r,e);return t instanceof Error?t:(r=t[0],e=t[1],0===r.length||0===e?i.na:1===r.length||1===e.length?i.div0:Math.pow(n.PEARSON(r,e),2))},n.SKEW=function(){var r=u.parseNumbers(s.flatten(arguments));if(r instanceof Error)return r;if(r.length<3)return i.div0;for(var n=a.mean(r),e=r.length,t=0,o=0;o<e;o++)t+=Math.pow(r[o]-n,3);return e*t/((e-1)*(e-2)*Math.pow(a.stdev(r,!0),3))},n.SKEW.P=function(){var r=u.parseNumbers(s.flatten(arguments));if(r instanceof Error)return r;if(r.length<3)return i.div0;for(var n=a.mean(r),e=r.length,t=0,o=0,f=0;f<e;f++)o+=Math.pow(r[f]-n,3),t+=Math.pow(r[f]-n,2);return o/=e,t/=e,o/Math.pow(t,1.5)},n.SLOPE=function(r,n){var e=u.parseNumbersX(n,r);if(e instanceof Error)return e;if(n=e[0],r=e[1],0===n.length||0===r)return i.na;for(var t=a.mean(n),o=a.mean(r),f=n.length,s=0,c=0,l=0;l<f;l++)s+=(n[l]-t)*(r[l]-o),c+=Math.pow(n[l]-t,2);return 0===c?i.div0:s/c},n.SMALL=function(r,n){return r=u.parseNumbers(s.flatten(r)),r instanceof Error?r:0===r.length?i.num:(n=u.parseNumber(n),n instanceof Error?n:n<=0||n>r.length?i.num:r.sort(function(r,n){return r-n})[n-1])},n.STANDARDIZE=function(r,n,e){return r=u.parseNumber(r),r instanceof Error?r:(n=u.parseNumber(n),n instanceof Error?n:(e=u.parseNumber(e),e instanceof Error?e:e<=0?i.num:(r-n)/e))},n.STDEV={},n.STDEV.P=function(){var r=n.VAR.P.apply(this,arguments);return r instanceof Error?r:Math.sqrt(r)},n.STDEV.S=function(){var r=n.VAR.S.apply(this,arguments);return r instanceof Error?r:Math.sqrt(r)},n.STDEVA=function(){var r=n.VARA.apply(this,arguments);return r instanceof Error?r:Math.sqrt(r)},n.STDEVPA=function(){var r=n.VARPA.apply(this,arguments);return r instanceof Error?r:Math.sqrt(r)},n.STEYX=function(r,n){var e=u.parseNumbersX(n,r);if(e instanceof Error)return e;if(n=e[0],r=e[1],0===n.length||0===r)return i.na;for(var t=a.mean(n),o=a.mean(r),f=n.length,s=0,c=0,l=0,m=0;m<f;m++)s+=Math.pow(r[m]-o,2),c+=(n[m]-t)*(r[m]-o),l+=Math.pow(n[m]-t,2);return 0===l?i.div0:Math.sqrt((s-c*c/l)/(f-2))},n.T=o.T,n.T.DIST=function(r,n,e){return r=u.parseNumber(r),r instanceof Error?r:(n=u.parseNumber(n),n instanceof Error?n:n<1?i.num:(e=u.parseBool(e),e instanceof Error?e:e?a.studentt.cdf(r,n):a.studentt.pdf(r,n)))},n.T.DIST["2T"]=function(){throw new Error("T.DIST.2T is not implemented")},n.T.DIST.RT=function(){throw new Error("T.DIST.RT is not implemented")},n.T.INV=function(r,n){return r=u.parseNumber(r),r instanceof Error?r:r<=0||r>1?i.num:(n=u.parseNumber(n),n instanceof Error?n:n<1?i.num:(n=Math.floor(n),a.studentt.inv(r,n)))},n.T.INV["2T"]=function(){throw new Error("T.INV.2T is not implemented")},n.T.TEST=function(){throw new Error("T.TEST is not implemented")},n.TREND=function(){throw new Error("TREND is not implemented")},n.TRIMMEAN=function(r,n){if(r=u.parseNumbers(s.flatten(r)),r instanceof Error)return r;if(n=u.parseNumber(n),n instanceof Error)return n;if(n<0||n>1)return i.num;var e=t.FLOOR(r.length*n,2)/2;return a.mean(s.initial(s.rest(r.sort(function(r,n){return r-n}),e),e))},n.VAR={},n.VAR.P=function(){var r=u.parseNumbers(s.flatten(arguments));if(r instanceof Error)return r;for(var e=0,t=n.AVERAGE(r),o=0;o<r.length;o++)e+=Math.pow(r[o]-t,2);return e/r.length},n.VAR.S=function(){var r=u.parseNumbers(s.flatten(arguments));if(r instanceof Error)return r;for(var e=0,t=n.AVERAGE(r),o=0;o<r.length;o++)e+=Math.pow(r[o]-t,2);return e/(r.length-1)},n.VARA=function(){var r=u.parseNumbersA(s.flatten(arguments));if(r instanceof Error)return r;for(var e=0,t=n.AVERAGEA(r),o=0;o<r.length;o++)e+=Math.pow(r[o]-t,2);return e/(r.length-1)},n.VARPA=function(){var r=u.parseNumbersA(s.flatten(arguments));if(r instanceof Error)return r;for(var e=0,t=n.AVERAGEA(r),o=0;o<r.length;o++)e+=Math.pow(r[o]-t,2);return e/r.length},n.WEIBULL={},n.WEIBULL.DIST=function(r,n,e,t){return r=u.parseNumber(r),r instanceof Error?r:(n=u.parseNumber(n),n instanceof Error?n:n<=0?i.num:(e=u.parseNumber(e),e instanceof Error?e:e<=0?i.num:(t=u.parseBool(t),t instanceof Error?t:t?1-Math.exp(-Math.pow(r/e,n)):Math.pow(r,n-1)*Math.exp(-Math.pow(r/e,n))*n/Math.pow(e,n))))},n.Z={},n.Z.TEST=function(r,e,t){if(r=u.parseNumbers(s.flatten(r)),r instanceof Error)return r;if(0===r.length)return i.na;if(e=u.parseNumber(e),e instanceof Error)return e;t=t||n.STDEV.S(r);var o=r.length;return 1-n.NORM.S.DIST((n.AVERAGE(r)-e)/(t/Math.sqrt(o)),!0)}},function(r,n,e){var t=e(4),o=e(5),a=e(2),u=e(7),i=e(8),f=e(10),s=e(6);n.ABS=function(r){return r=t.parseNumber(r),r instanceof Error?r:Math.abs(t.parseNumber(r))},n.ACOS=function(r){return r=t.parseNumber(r),r instanceof Error?r:r<-1||r>1?o.num:Math.acos(r)},n.ACOSH=function(r){return r=t.parseNumber(r),r instanceof Error?r:r<1?o.num:Math.log(r+Math.sqrt(r*r-1))},n.ACOT=function(r){return r=t.parseNumber(r),r instanceof Error?r:Math.atan(1/r)},n.ACOTH=function(r){return r=t.parseNumber(r),r instanceof Error?r:.5*Math.log((r+1)/(r-1))},n.AGGREGATE=function(r,e,o,u){if(r=t.parseNumber(r),r instanceof Error)return r;if(e=t.parseNumber(r),e instanceof Error)return e;switch(r){case 1:return a.AVERAGE(o);case 2:return a.COUNT(o);case 3:return a.COUNTA(o);case 4:return a.MAX(o);case 5:return a.MIN(o);case 6:return n.PRODUCT(o);case 7:return a.STDEV.S(o);case 8:return a.STDEV.P(o);case 9:return n.SUM(o);case 10:return a.VAR.S(o);case 11:return a.VAR.P(o);case 12:return a.MEDIAN(o);case 13:return a.MODE.SNGL(o);case 14:return a.LARGE(o,u);case 15:return a.SMALL(o,u);case 16:return a.PERCENTILE.INC(o,u);case 17:return a.QUARTILE.INC(o,u);case 18:return a.PERCENTILE.EXC(o,u);case 19:return a.QUARTILE.EXC(o,u)}},n.ARABIC=function(r){if(r=r.trim().toUpperCase(),!/^-?M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(r))return o.value;var n=0;return r.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(r){n+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[r]}),"-"===r[0]&&(n*=-1),n},n.ASIN=function(r){return r=t.parseNumber(r),r instanceof Error?r:r<-1||r>1?o.num:Math.asin(r)},n.ASINH=function(r){return r=t.parseNumber(r),r instanceof Error?r:Math.log(r+Math.sqrt(r*r+1))},n.ATAN=function(r){return r=t.parseNumber(r),r instanceof Error?r:Math.atan(r)},n.ATAN2=function(r,n){return r=t.parseNumber(r),r instanceof Error?r:(n=t.parseNumber(n),n instanceof Error?n:Math.atan2(r,n))},n.ATANH=function(r){return r=t.parseNumber(r),r instanceof Error?r:r<=-1||r>=1?o.num:Math.log((1+r)/(1-r))/2},n.BASE=function(r,n,e){if(void 0!==e&&null!==e||(e=0),r=t.parseNumber(r),r instanceof Error)return r;if(r<0||r>=2e53)return o.num;if(n=t.parseNumber(n),n instanceof Error)return n;if(n<2||n>36)return o.num;if(e=t.parseNumber(e),e instanceof Error)return e;if(e<0)return o.num;var a=r.toString(n);return new Array(Math.max(e+1-a.length,0)).join("0")+a},n.CEILING=function(r,e){return n.CEILING.MATH(r,Math.abs(e),e>=0?0:-1)},n.CEILING.MATH=function(r,e,o){return e=void 0===e?1:Math.abs(e),o=o||0,r=t.parseNumber(r),r instanceof Error?r:(e=t.parseNumber(e),e instanceof Error?e:(o=t.parseNumber(o),o instanceof Error?o:0===e?0:r>=0?n.MROUND(Math.ceil(r/e)*e,e):0===o?-n.MROUND(Math.floor(Math.abs(r)/e)*e,e):-n.MROUND(Math.ceil(Math.abs(r)/e)*e,e)))},n.CEILING.PRECISE=n.CEILING,n.COMBIN=function(r,e){return r=t.parseNumber(r),r instanceof Error?r:(e=t.parseNumber(e),e instanceof Error?e:n.FACT(r)/(n.FACT(e)*n.FACT(r-e)))},n.COMBINA=function(r,e){return r=t.parseNumber(r),r instanceof Error?r:(e=t.parseNumber(e),e instanceof Error?e:0===r&&0===e?1:n.COMBIN(r+e-1,r-1))},n.COS=function(r){return r=t.parseNumber(r),r instanceof Error?r:Math.cos(r)},n.COSH=function(r){return r=t.parseNumber(r),r instanceof Error?r:(Math.exp(r)+Math.exp(-r))/2},n.COT=function(r){return r=t.parseNumber(r),r instanceof Error?r:1/Math.tan(r)},n.COTH=function(r){if(r=t.parseNumber(r),r instanceof Error)return r;var n=Math.exp(2*r);return(n+1)/(n-1)},n.CSC=function(r){return r=t.parseNumber(r),r instanceof Error?r:1/Math.sin(r)},n.CSCH=function(r){return r=t.parseNumber(r),r instanceof Error?r:2/(Math.exp(r)-Math.exp(-r))},n.DECIMAL=function(r,n){return r instanceof Error?r:(n=t.parseNumber(n),n instanceof Error?n:n<2||n>36?o.num:(r=parseInt(r,n),isNaN(r)?o.num:r))},n.DEGREES=function(r){return r=t.parseNumber(r),r instanceof Error?r:180*r/Math.PI},n.EVEN=function(r){return r=t.parseNumber(r),r instanceof Error?r:n.CEILING(r,-2,-1)},n.EXP=Math.exp;var c=[];n.FACT=function(r){if(r=t.parseNumber(r),r instanceof Error)return r;if(r<0)return o.num;var e=Math.floor(r);return 0===e||1===e?1:c[e]>0?c[e]:(c[e]=n.FACT(e-1)*e,c[e])},n.FACTDOUBLE=function(r){if(r=t.parseNumber(r),r instanceof Error)return r;if(r<0)return o.num;var e=Math.floor(r);return e<=1?1:e*n.FACTDOUBLE(e-2)},n.FLOOR=function(r,e){return r=t.parseNumber(r),r instanceof Error?r:(e=t.parseNumber(e),e instanceof Error?e:0===e?0:r>0&&e>0||r<0&&e<0?(e=Math.abs(e),r>=0?n.MROUND(Math.floor(r/e)*e,e):-n.MROUND(Math.ceil(Math.abs(r)/e),e)):o.num)},n.FLOOR.MATH=function(r,e,o){return e=void 0===e?1:e,o=void 0===o?0:o,r=t.parseNumber(r),r instanceof Error?r:(e=t.parseNumber(e),e instanceof Error?e:(o=t.parseNumber(o),o instanceof Error?o:0===e?0:(e=e?Math.abs(e):1,r>=0?n.MROUND(Math.floor(r/e)*e,e):0===o||void 0===o?-n.MROUND(Math.ceil(Math.abs(r)/e)*e,e):-n.MROUND(Math.floor(Math.abs(r)/e)*e,e))))},n.FLOOR.PRECISE=n.FLOOR.MATH,n.GCD=function(){var r=t.parseNumbersConvert(s.flatten(arguments));if(r instanceof Error)return r;if(0===r.length)return o.value;for(var n=r[0],e=n<0?-n:n,a=1;a<r.length;a++){for(var u=r[a],i=u<0?-u:u;e&&i;)e>i?e%=i:i%=e;e+=i}return e},n.INT=function(r){return r=t.parseNumber(r),r instanceof Error?r:Math.floor(r)},n.ISO={CEILING:n.CEILING},n.LCM=function(){function r(r){return r.reduce(function(r,e){return Math.abs(r*e)/n.GCD(r,e)})}for(var e=s.flatten(arguments),a=e.length;a--;){if(e[a]=t.parseNumber(e[a]),e[a]instanceof Error)return e[a];if(0===e[a])return 0;if(e[a]<0)return o.num}return r(e)},n.LN=function(r){return r=t.parseNumber(r),r instanceof Error?r:r<=0?o.num:Math.log(r)},n.LOG=function(r,n){if(n=void 0===n?10:n,r=t.parseNumber(r),r instanceof Error)return r;if(r<=0)return o.num;if(n=t.parseNumber(n),n instanceof Error)return n;if(n<=0)return o.num;var e=Math.log(n);return 0===e?o.div0:Math.log(r)/e},n.LOG10=function(r){return r=t.parseNumber(r),r instanceof Error?r:r<=0?o.num:Math.log(r)/Math.log(10)},n.MDETERM=function(r){if(r=t.parseMatrix(r),r instanceof Error)return r;var n=f.dim(r);if(2!==n.length||n[0]!==n[1])throw new Error("can only calculate determinant on square matrices");var e,o,a,u,i,s,c,l,m=n[0],p=1,h=r;for(o=0;o<m-1;o++){for(a=o,e=o+1;e<m;e++)Math.abs(h[e][o])>Math.abs(h[a][o])&&(a=e);for(a!==o&&(c=h[a],h[a]=h[o],h[o]=c,p*=-1),u=h[o],e=o+1;e<m;e++){for(i=h[e],s=i[o]/u[o],a=o+1;a<m-1;a+=2)l=a+1,i[a]-=u[a]*s,i[l]-=u[l]*s;a!==m&&(i[a]-=u[a]*s)}if(0===u[o])return 0;p*=u[o]}return p*h[o][o]},n.MINVERSE=function(r){if(r=t.parseMatrix(r),r instanceof Error)return r;var n,e,o,a,u,i,s,c=f.dim(r),l=c[0],m=c[1],p=r,h=f.identity(l);for(i=0;i<m;++i){var E=-1,v=-1;for(u=i;u!==l;++u)s=Math.abs(p[u][i]),s>v&&(E=u,v=s);for(e=p[E],p[E]=p[i],p[i]=e,a=h[E],h[E]=h[i],h[i]=a,r=e[i],s=i;s!==m;++s)e[s]/=r;for(s=m-1;s!==-1;--s)a[s]/=r;for(u=l-1;u!==-1;--u)if(u!==i){for(n=p[u],o=h[u],r=n[i],s=i+1;s!==m;++s)n[s]-=e[s]*r;for(s=m-1;s>0;--s)o[s]-=a[s]*r,--s,o[s]-=a[s]*r;0===s&&(o[0]-=a[0]*r)}}return h},n.MMULT=function(r,n){
if(r=t.parseMatrix(r),r instanceof Error)return r;if(n=t.parseMatrix(n),n instanceof Error)return n;for(var e=[],o=0;o<n.length;o++){e[o]=[];for(var a=0;a<r[0].length;a++){for(var u=0,i=0;i<r.length;i++)u+=r[i][a]*n[o][i];e[o][a]=u}}return e},n.MOD=function(r,n){if(r=t.parseNumber(r),r instanceof Error)return r;if(n=t.parseNumber(n),n instanceof Error)return n;if(0===n)return o.div0;var e=Math.abs(r%n);return n>0?e:-e},n.MROUND=function(r,n){return r=t.parseNumber(r),r instanceof Error?r:(n=t.parseNumber(n),n instanceof Error?n:r*n<0?o.num:Math.round(r/n)*n)},n.MULTINOMIAL=function(){for(var r=s.flatten(arguments),e=r.length,o=0;o<e;o++)if(r[o]=t.parseNumber(r[o]),r[o]instanceof Error)return r[o];for(var a=0,u=1,o=0;o<r.length;o++)a+=r[o],u*=n.FACT(r[o]);return n.FACT(a)/u},n.MUNIT=function(r){return r=t.parseNumber(r),r instanceof Error?r:f.identity(r)},n.ODD=function(r){if(r=t.parseNumber(r),r instanceof Error)return r;var n=Math.ceil(Math.abs(r));return n=1&n?n:n+1,r>0?n:-n},n.PI=function(){return Math.PI},n.POWER=function(r,n){if(r=t.parseNumber(r),r instanceof Error)return r;if(n=t.parseNumber(n),n instanceof Error)return n;var e=Math.pow(r,n);return isNaN(e)?o.num:e},n.PRODUCT=function(){var r=t.parseNumbers(s.flatten(arguments));if(r instanceof Error)return r;for(var n=1,e=0;e<r.length;e++)n*=r[e];return n},n.QUOTIENT=function(r,n){return r=t.parseNumber(r),r instanceof Error?r:(n=t.parseNumber(n),n instanceof Error?n:0===n?o.div0:parseInt(r/n,10))},n.RADIANS=function(r){return r=t.parseNumber(r),r instanceof Error?r:r*Math.PI/180},n.RAND=function(){return Math.random()},n.RANDBETWEEN=function(r,n){return r=t.parseNumber(r),r instanceof Error?r:(n=t.parseNumber(n),n instanceof Error?n:r+Math.ceil((n-r+1)*Math.random())-1)},n.ROMAN=function(r){if(r=t.parseNumber(r),r instanceof Error)return r;for(var n=String(r).split(""),e=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],o="",a=3;a--;)o=(e[+n.pop()+10*a]||"")+o;return new Array(+n.join("")+1).join("M")+o},n.ROUND=function(r,n){if(r=t.parseNumber(r),r instanceof Error)return r;if(n=t.parseNumber(n),n instanceof Error)return n;var e=r>0?1:-1;return e*Math.round(Math.abs(r)*Math.pow(10,n))/Math.pow(10,n)},n.ROUNDDOWN=function(r,n){if(r=t.parseNumber(r),r instanceof Error)return r;if(n=t.parseNumber(n),n instanceof Error)return n;var e=r>0?1:-1;return e*Math.floor(Math.abs(r)*Math.pow(10,n))/Math.pow(10,n)},n.ROUNDUP=function(r,n){if(r=t.parseNumber(r),r instanceof Error)return r;if(n=t.parseNumber(n),n instanceof Error)return n;var e=r>0?1:-1;return e*Math.ceil(Math.abs(r)*Math.pow(10,n))/Math.pow(10,n)},n.SEC=function(r){return r=t.parseNumber(r),r instanceof Error?r:1/Math.cos(r)},n.SECH=function(r){return r=t.parseNumber(r),r instanceof Error?r:2/(Math.exp(r)+Math.exp(-r))},n.SERIESSUM=function(r,n,e,o){if(r=t.parseNumber(r),r instanceof Error)return r;if(n=t.parseNumber(n),n instanceof Error)return n;if(e=t.parseNumber(e),e instanceof Error)return e;if(o=t.parseNumbers(o),o instanceof Error)return o;for(var a=o[0]*Math.pow(r,n),u=1;u<o.length;u++)a+=o[u]*Math.pow(r,n+u*e);return a},n.SIGN=function(r){return r=t.parseNumber(r),r instanceof Error?r:r<0?-1:0===r?0:1},n.SIN=function(r){return r=t.parseNumber(r),r instanceof Error?r:Math.sin(r)},n.SINH=function(r){return r=t.parseNumber(r),r instanceof Error?r:(Math.exp(r)-Math.exp(-r))/2},n.SQRT=function(r){return r=t.parseNumber(r),r instanceof Error?r:r<0?o.num:Math.sqrt(r)},n.SQRTPI=function(r){return r=t.parseNumber(r),r instanceof Error?r:r<0?o.num:Math.sqrt(r*Math.PI)},n.SUBTOTAL=function(){var r=t.argsToArray(arguments),e=t.parseNumber(r.shift());if(e instanceof Error)return e;switch(e){case 1:return a.AVERAGE(r);case 2:return a.COUNT(r);case 3:return a.COUNTA(r);case 4:return a.MAX(r);case 5:return a.MIN(r);case 6:return n.PRODUCT(r);case 7:return a.STDEV.S(r);case 8:return a.STDEV.P(r);case 9:return n.SUM(r);case 10:return a.VAR.S(r);case 11:return a.VAR.P(r);case 101:return a.AVERAGE(r);case 102:return a.COUNT(r);case 103:return a.COUNTA(r);case 104:return a.MAX(r);case 105:return a.MIN(r);case 106:return n.PRODUCT(r);case 107:return a.STDEV.S(r);case 108:return a.STDEV.P(r);case 109:return n.SUM(r);case 110:return a.VAR.S(r);case 111:return a.VAR.P(r)}},n.SUM=function(){for(var r=t.parseNumbers(s.flatten(arguments)),n=0,e=r.length;e--;)n+=r[e];return n},n.SUMIF=function(r,n,e){if(r=s.flatten(r),e=void 0!==e?s.flatten(e):r,e instanceof Error)return e;n=/[><=!]/.test(n)?n[0]+JSON.stringify(n.slice(1)):"="+JSON.stringify(n);for(var t=0,o=0;o<e.length;o++){if(e[o]instanceof Error)return e[o];"number"==typeof e[o]&&i(JSON.stringify(r[o])+n)&&(t+=e[o])}return t},n.SUMIFS=function(){for(var r=t.argsToArray(arguments),n=s.flatten(r.shift()),e=0,a=0;a<n.length;a++)if("number"==typeof n[a]){for(var u=!0,f=0;f<r.length;f+=2){if(r[f].length!==n.length)return o.value;var c=r[f+1];if(/[><=!]/.test(c)){var l=c.slice(1);c=isNaN(parseFloat(l))?c[0]+JSON.stringify(l):c[0]+l}else c=isNaN(parseFloat(c))?"="+JSON.stringify(c):"="+c;if(!i(JSON.stringify(r[f][a])+c)){u=!1;break}}u&&(e+=n[a])}return e},n.SUMPRODUCT=function(){if(!arguments||0===arguments.length)return o.value;var r,n,e=arguments.length+1,a=0;if(!(arguments[0]instanceof Array)){for(r=1,n=0;n<arguments.length;n++){if("number"!=typeof arguments[n])return o.value;r*=arguments[n]}return r}var u,i,f;for(n=0;n<arguments[0].length;n++)if(arguments[0][n]instanceof Array)for(var s=0;s<arguments[0][n].length;s++){for(r=1,u=1;u<e;u++){if(f=t.parseNumber(arguments[u-1][n][s]),f instanceof Error)return f;r*=f}a+=r}else{for(r=1,u=1;u<e;u++){if(i=t.parseNumber(arguments[u-1][n]),i instanceof Error)return i;r*=i}a+=r}return a},n.SUMSQ=function(){var r=t.parseNumbers(s.flatten(arguments));if(r instanceof Error)return r;for(var n=0,e=r.length,o=0;o<e;o++)n+=u.ISNUMBER(r[o])?r[o]*r[o]:0;return n},n.SUMX2MY2=function(r,n){var e=t.parseNumbersX(r,n);if(e instanceof Error)return e;for(var o=e[0],a=e[1],u=0,i=0;i<o.length;i++)u+=o[i]*o[i]-a[i]*a[i];return u},n.SUMX2PY2=function(r,n){var e=t.parseNumbersX(r,n);if(e instanceof Error)return e;for(var o=e[0],a=e[1],u=0,i=0;i<o.length;i++)u+=o[i]*o[i]+a[i]*a[i];return u},n.SUMXMY2=function(r,n){var e=t.parseNumbersX(r,n);if(e instanceof Error)return e;for(var o=e[0],a=e[1],u=0,i=0;i<o.length;i++)u+=Math.pow(o[i]-a[i],2);return u},n.TAN=function(r){return r=t.parseNumber(r),r instanceof Error?r:Math.tan(r)},n.TANH=function(r){if(r=t.parseNumber(r),r instanceof Error)return r;var n=Math.exp(2*r);return(n-1)/(n+1)},n.TRUNC=function(r,n){if(n=void 0===n?0:n,r=t.parseNumber(r),r instanceof Error)return r;if(n=t.parseNumber(n),n instanceof Error)return n;var e=r>0?1:-1;return e*Math.floor(Math.abs(r)*Math.pow(10,n))/Math.pow(10,n)}},function(r,n,e){var t=e(5);e(6);n.argsToArray=function(r){return Array.prototype.slice.call(r,0)},n.cleanFloat=function(r){var n=1e14;return Math.round(r*n)/n},n.parseBool=function(r){if("boolean"==typeof r)return r;if(r instanceof Error)return r;if("number"==typeof r)return 0!==r;if("string"==typeof r){var n=r.toUpperCase();if("TRUE"===n)return!0;if("FALSE"===n)return!1}return r instanceof Date&&!isNaN(r)||t.value},n.parseNumber=function(r){if(r instanceof Error)return r;if(void 0===r||null===r)return 0;if(r===!1)return 0;if(r===!0)return 1;if(!isNaN(r)){var n=parseFloat(r);if(!isNaN(n))return n}return t.value},n.parseNumbers=function(r){if(r instanceof Error)return r;if(!(r instanceof Array))return t.value;for(var n=[],e=0;e<r.length;e++){if(r[e]instanceof Error)return r[e];"number"==typeof r[e]&&n.push(r[e])}return n},n.parseNumbersA=function(r){if(r instanceof Error)return r;if(!(r instanceof Array))return t.value;for(var n=[],e=0;e<r.length;e++){if(r[e]instanceof Error)return r[e];void 0!==r[e]&&null!==r[e]&&(r[e]===!1?n.push(0):r[e]===!0?n.push(1):"number"!=typeof r[e]?n.push(0):n.push(r[e]))}return n},n.parseNumbersConvert=function(r){if(r instanceof Error)return r;if(!(r instanceof Array))return t.value;for(var n=[],e=0;e<r.length;e++){if(r[e]instanceof Error)return r[e];if(void 0===r[e]||null===r[e])n.push(0);else{var o=parseFloat(r[e]);if(isNaN(o))return t.value;n.push(o)}}return n},n.parseNumbersX=function(r,n){if(r instanceof Error)return r;if(n instanceof Error)return n;if(!(r instanceof Array&&n instanceof Array))return t.value;if(r.length!==n.length)return t.na;for(var e=[],o=[],a=0;a<r.length;a++){if(r[a]instanceof Error)return r[a];if(n[a]instanceof Error)return n[a];"number"==typeof r[a]&&"number"==typeof n[a]&&(e.push(r[a]),o.push(n[a]))}return[e,o]},n.parseMatrix=function(r){r instanceof Array||(r=[r]),r[0]instanceof Array||(r=[r]);for(var e=0;e<r.length;e++)for(var o=0;o<r[0].length;o++)if(r[e][o]=n.parseNumber(r[e][o]),r[e][o]instanceof Error)return r[e][o];return 0===r.length||0===r[0].length?t.value:r},n.excelToJsTimestamp=function(r){return r<60&&r++,Math.round(864e5*(r-25569))},n.jsToExcelTimestamp=function(r){return r=r/864e5+25569,r<=60&&r--,r},n.createUTCDate=function(r,n,e,t,o,a,u){if(1===arguments.length&&"string"!=typeof r)return new Date(r);var i=null;return 0===arguments.length?i=new Date:1===arguments.length?i=new Date(r):2===arguments.length?i=new Date(r,n):3===arguments.length?i=new Date(r,n,e):4===arguments.length?i=new Date(r,n,e,t):5===arguments.length?i=new Date(r,n,e,t,o):6===arguments.length?i=new Date(r,n,e,t,o,a):7===arguments.length&&(i=new Date(r,n,n,e,t,o,a,u)),new Date(i.getTime()-6e4*i.getTimezoneOffset())},n.parseDate=function(r){if(null!==r&&void 0!==r&&!isNaN(r)){if(r instanceof Date)return n.createUTCDate(r);var e=parseFloat(r);return e<0?t.num:n.createUTCDate(n.excelToJsTimestamp(e))}return"string"!=typeof r||(r=n.createUTCDate(r),isNaN(r))?t.value:r},n.parseDates=function(r){if(!(r instanceof Array))return t.value;for(var e=[],o=0;o<r.length;o++){if(r[o]instanceof Error)return r[o];if(null!==r[o]&&void 0!==r[o]){var a=n.parseDate(r[o]);if(a instanceof Error)return a;e[e.length]=a}}return e},n.parseText=function(r){return r instanceof Error?r:void 0===r||null===r?"":"string"==typeof r?r:"number"==typeof r?r.toString():"boolean"==typeof r?r.toString().toUpperCase():t.value}},function(r,n){n.nil=new Error("#NULL!"),n.div0=new Error("#DIV/0!"),n.value=new Error("#VALUE!"),n.ref=new Error("#REF!"),n.name=new Error("#NAME?"),n.num=new Error("#NUM!"),n.na=new Error("#N/A"),n.data=new Error("#GETTING_DATA")},function(r,n){function e(r,n,e){if(null===r)return!0;n=_.iteratee(n,e);var t,o,a=r.length!==+r.length&&_.keys(r),u=(a||r).length;for(t=0;t<u;t++)if(o=a?a[t]:t,!n(r[o],o,r))return!1;return!0}function t(r){return r&&"[object Arguments]"===r.toString()}function o(r,n,e){var t=-1,o=r?r.length:0;if(n=null===n?0:+n||0,n<0&&(n=-n>o?0:o+n),e=void 0===e||e>o?o:+e||0,e<0&&(e+=o),e&&e==o&&!n)return baseSlice(r);o=n>e?0:e-n;for(var a=Array(o);++t<o;)a[t]=r[t+n];return a}n.flatten=function(r,n){return a(r,n,!1,[])},n.initial=function(r){var n=r?r.length:0;return o(r,0,n?n-1:0)},n.rest=function(r){return o(r,1)};var a=function r(n,o,a,u){if(o&&e(n,Array.isArray))return concat.apply(u,n);for(var i=0,f=n.length;i<f;i++){var s=n[i];Array.isArray(s)||t(s)?o?push.apply(u,s):r(s,o,a,u):a||u.push(s)}return u};n.uniq=function(r){if(null===r)return[];for(var n=[],e=0,t=r.length;e<t;e++){var o=r[e];n.indexOf(o)<0&&n.push(o)}return n}},function(r,n,e){var t=e(4),o=e(5);n.CELL=function(){throw new Error("CELL is not implemented")},n.ERROR={},n.ERROR.TYPE=function(r){switch(r){case o.nil:return 1;case o.div0:return 2;case o.value:return 3;case o.ref:return 4;case o.name:return 5;case o.num:return 6;case o.na:return 7;case o.data:return 8}return o.na},n.INFO=function(){throw new Error("INFO is not implemented")},n.ISBLANK=function(r){return null===r},n.ISERR=function(r){return[o.value,o.ref,o.div0,o.num,o.name,o.nil].indexOf(r)>=0||"number"==typeof r&&(isNaN(r)||!isFinite(r))},n.ISERROR=function(r){return n.ISERR(r)||r===o.na},n.ISEVEN=function(r){return r=t.parseNumber(r),r instanceof Error?r:!(1&Math.floor(Math.abs(r)))},n.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},n.ISLOGICAL=function(r){return r===!0||r===!1},n.ISNA=function(r){return r===o.na},n.ISNONTEXT=function(r){return"string"!=typeof r},n.ISNUMBER=function(r){return"number"==typeof r&&!isNaN(r)&&isFinite(r)},n.ISODD=function(r){return r=t.parseNumber(r),r instanceof Error?r:!!(1&Math.floor(Math.abs(r)))},n.ISREF=function(){throw new Error("ISREF is not implemented")},n.ISTEXT=function(r){return"string"==typeof r},n.N=function(r){return n.ISNUMBER(r)?r:r instanceof Date?t.jsToExcelTimestamp(r.getTime()):r===!0?1:r===!1?0:n.ISERROR(r)?r:0},n.NA=function(){return o.na},n.SHEET=function(){throw new Error("SHEET is not implemented")},n.SHEETS=function(){throw new Error("SHEETS is not implemented")},n.TYPE=function(r){return n.ISNUMBER(r)?1:n.ISTEXT(r)?2:n.ISLOGICAL(r)?4:n.ISERROR(r)?16:Array.isArray(r)?64:void 0}},function(r,n,e){function t(r,n){if("BinaryExpression"===r.type){var e=a[r.operator];if(!e)throw new Error("Unknown binary operator "+r.operator);return e(t(r.left),t(r.right))}if("UnaryExpression"===r.type){var o=u[r.operator];if(!o)throw new Error("Unknown unary operator "+r.operator);return o(t(r.argument))}if("LogicalExpression"===r.type){var f=i[r.operator];if(!f)throw new Error("Unknown logical operator "+r.operator);return f(t(r.left),t(r.right))}if("Literal"===r.type)return r.value;if("Identifier"===r.type)return n?n[r.name]:void 0;throw new Error("Unsupported expr node",r)}var o=e(9);o.addBinaryOp("=",6);var a={"+":function(r,n){return r+n},"-":function(r,n){return r-n},"*":function(r,n){return r*n},"/":function(r,n){return r/n},"%":function(r,n){return r%n},">":function(r,n){return r>n},">=":function(r,n){return r>=n},"<":function(r,n){return r<n},"<=":function(r,n){return r<=n},"=":function(r,n){return r==n},"==":function(r,n){return r==n},"!=":function(r,n){return r!==n}},u={"-":function(r){return-r},"!":function(r){return!r}},i={"&&":function(r,n){return r&&n},"||":function(r,n){return r||n}};r.exports=function(r,n){var e=o(r);return t(e,n)}},function(r,n,e){!function(e){"use strict";var t="Compound",o="Identifier",a="MemberExpression",u="Literal",i="ThisExpression",f="CallExpression",s="UnaryExpression",c="BinaryExpression",l="LogicalExpression",m="ConditionalExpression",p="Array",h=46,E=44,v=39,g=34,N=40,b=41,d=91,M=93,I=63,T=59,A=58,w=function(r,n){var e=new Error(r+" at character "+n);throw e.index=n,e.dedscription=r,e},y=!0,C={"-":y,"!":y,"~":y,"+":y},S={"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},R=function(r){var n,e=0;for(var t in r)(n=t.length)>e&&r.hasOwnProperty(t)&&(e=n);return e},O=R(C),D=R(S),x={true:!0,false:!1,null:null},U="this",L=function(r){return S[r]||0},P=function(r,n,e){var t="||"===r||"&&"===r?l:c;return{type:t,operator:r,left:n,right:e}},V=function(r){return r>=48&&r<=57},F=function(r){return 36===r||95===r||r>=65&&r<=90||r>=97&&r<=122},B=function(r){return 36===r||95===r||r>=65&&r<=90||r>=97&&r<=122||r>=48&&r<=57},G=function(r){for(var n,e,c=0,l=r.charAt,y=r.charCodeAt,R=function(n){return l.call(r,n)},G=function(n){return y.call(r,n)},q=r.length,_=function(){for(var r=G(c);32===r||9===r;)r=G(++c)},Y=function(){var r,n,e=j();return _(),G(c)!==I?e:(c++,r=Y(),r||w("Expected expression",c),_(),G(c)===A?(c++,n=Y(),n||w("Expected expression",c),{type:m,test:e,consequent:r,alternate:n}):void w("Expected :",c))},X=function(){_();for(var n=r.substr(c,D),e=n.length;e>0;){if(S.hasOwnProperty(n))return c+=e,n;n=n.substr(0,--e)}return!1},j=function(){var r,n,e,t,o,a,u,i;if(a=H(),n=X(),!n)return a;for(o={value:n,prec:L(n)},u=H(),u||w("Expected expression after "+n,c),t=[a,o,u];(n=X())&&(e=L(n),0!==e);){for(o={value:n,prec:e};t.length>2&&e<=t[t.length-2].prec;)u=t.pop(),n=t.pop().value,a=t.pop(),r=P(n,a,u),t.push(r);r=H(),r||w("Expected expression after "+n,c),t.push(o,r)}for(i=t.length-1,r=t[i];i>1;)r=P(t[i-1].value,t[i-2],r),i-=2;return r},H=function(){var n,e,t;if(_(),n=G(c),V(n)||n===h)return k();if(n===v||n===g)return K();if(F(n)||n===N)return z();for(e=r.substr(c,O),t=e.length;t>0;){if(C.hasOwnProperty(e))return c+=t,{type:s,operator:e,argument:H(),prefix:!0};e=e.substr(0,--t)}return!1},k=function(){for(var r,n="";V(G(c));)n+=R(c++);if(G(c)===h)for(n+=R(c++);V(G(c));)n+=R(c++);if(r=R(c),"e"===r||"E"===r){for(n+=R(c++),r=R(c),"+"!==r&&"-"!==r||(n+=R(c++));V(G(c));)n+=R(c++);V(G(c-1))||w("Expected exponent ("+n+R(c)+")",c)}return F(G(c))&&w("Variable names cannot start with a number ("+n+R(c)+")",c),{type:u,value:parseFloat(n),raw:n}},K=function(){for(var r,n="",e=R(c++),t=!1;c<q;){if(r=R(c++),r===e){t=!0;break}if("\\"===r)switch(r=R(c++)){case"n":n+="\n";break;case"r":n+="\r";break;case"t":n+="\t";break;case"b":n+="\b";break;case"f":n+="\f";break;case"v":n+="\v"}else n+=r}return t||w('Unclosed quote after "'+n+'"',c),{type:u,value:n,raw:e+n+e}},Q=function(){var n,e=G(c),t=c;for(F(e)?c++:w("Unexpected "+R(c),c);c<q&&(e=G(c),B(e));)c++;return n=r.slice(t,c),x.hasOwnProperty(n)?{type:u,value:x[n],raw:n}:n===U?{type:i}:{type:o,name:n}},$=function(r){for(var n,e,o=[];c<q;){if(_(),n=G(c),n===r){c++;break}n===E?c++:(e=Y(),e&&e.type!==t||w("Expected comma",c),o.push(e))}return o},z=function(){var r,n;for(r=G(c),n=r===N?W():Q(),_(),r=G(c);r===h||r===d||r===N;)c++,r===h?(_(),n={type:a,computed:!1,object:n,property:Q()}):r===d?(n={type:a,computed:!0,object:n,property:Y()},_(),r=G(c),r!==M&&w("Unclosed [",c),c++):r===N&&(n={type:f,arguments:$(b),callee:n}),_(),r=G(c);return n},W=function(){c++;var r=Y();return _(),G(c)===b?(c++,r):void w("Unclosed (",c)},J=function(){return c++,{type:p,body:$(M)}},Z=[];c<q;)n=G(c),n===T||n===E?c++:n===d&&(e=J())?Z.push(e):(e=Y())?Z.push(e):c<q&&w('Unexpected "'+R(c)+'"',c);return 1===Z.length?Z[0]:{type:t,body:Z}};G.version="0.2.9",G.toString=function(){return"JavaScript Expression Parser (JSEP) v"+G.version},G.addUnaryOp=function(r){return C[r]=y,this},G.addBinaryOp=function(r,n){return D=Math.max(r.length,D),S[r]=n,this},G.removeUnaryOp=function(r){return delete C[r],r.length===O&&(O=R(C)),this},G.removeBinaryOp=function(r){return delete S[r],r.length===D&&(D=R(S)),this};"undefined"!=typeof r&&r.exports?n=r.exports=G:n.parse=G}(this)},function(r,n){function e(r){for(var n=[];"object"==typeof r;)n.push(r.length),r=r[0];return n}n.dim=function(r){var n,t;return"object"==typeof r?(n=r[0],"object"==typeof n?(t=n[0],"object"==typeof t?e(r):[r.length,n.length]):[r.length]):[]},n.diag=function(r){var n,e,t,o,a=r.length,u=Array(a);for(n=a-1;n>=0;n--){for(o=Array(a),e=n+2,t=a-1;t>=e;t-=2)o[t]=0,o[t-1]=0;for(t>n&&(o[t]=0),o[n]=r[n],t=n-1;t>=1;t-=2)o[t]=0,o[t-1]=0;0===t&&(o[0]=0),u[n]=o}return u},n.rep=function(r,e,t){void 0===t&&(t=0);var o,a=r[t],u=Array(a);if(t===r.length-1){for(o=a-2;o>=0;o-=2)u[o+1]=e,u[o]=e;return o===-1&&(u[0]=e),u}for(o=a-1;o>=0;o--)u[o]=n.rep(r,e,t+1);return u},n.identity=function(r){return n.diag(n.rep([r],1))},n.dotMMsmall=function(r,n){var e,t,o,a,u,i,f,s,c,l,m;for(a=r.length,u=n.length,i=n[0].length,f=Array(a),e=a-1;e>=0;e--){for(s=Array(i),c=r[e],o=i-1;o>=0;o--){for(l=c[u-1]*n[u-1][o],t=u-2;t>=1;t-=2)m=t-1,l+=c[t]*n[t][o]+c[m]*n[m][o];0===t&&(l+=c[0]*n[0][o]),s[o]=l}f[e]=s}return f},n.dotMMbig=function(r,e){function t(r,n,e){var t,o=r.length;for(t=o-1;t>0;--t)e[t]=r[t][n],--t,e[t]=r[t][n];0===t&&(e[0]=r[0][n])}var o,a,u,i,f=e.length,s=Array(f),c=r.length,l=e[0].length,m=new Array(c),p=n.dotVV;for(--f,--c,a=c;a!==-1;--a)m[a]=Array(l);for(--l,a=l;a!==-1;--a)for(t(e,a,s),u=c;u!==-1;--u)i=0,o=r[u],m[u][a]=p(o,s);return m},n.dotMV=function(r,e){var t,o=r.length,a=(e.length,Array(o)),u=n.dotVV;for(t=o-1;t>=0;t--)a[t]=u(r[t],e);return a},n.dotVM=function(r,n){var e,t,o,a,u,i,f;for(o=r.length,a=n[0].length,u=Array(a),t=a-1;t>=0;t--){for(i=r[o-1]*n[o-1][t],e=o-2;e>=1;e-=2)f=e-1,i+=r[e]*n[e][t]+r[f]*n[f][t];0===e&&(i+=r[0]*n[0][t]),u[t]=i}return u},n.dotVV=function(r,n){var e,t,o=r.length,a=r[o-1]*n[o-1];for(e=o-2;e>=1;e-=2)t=e-1,a+=r[e]*n[e]+r[t]*n[t];return 0===e&&(a+=r[0]*n[0]),a},n.mulVS=function(r,n){var e,t=r.length,o=Array(t);for(e=t-1;e!==-1;--e)o[e]=r[e]*n;return o},n.mulSV=function(r,n){var e,t=n.length,o=Array(t);for(e=t-1;e!==-1;--e)o[e]=r*n[e];return o}},function(r,n,e){var t=e(4),o=e(5),a=e(12),u=e(6);n.ASC=function(){throw new Error("ASC is not implemented")},n.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},n.CHAR=function(r){return r=t.parseNumber(r),r instanceof Error?r:r<1||r>255?o.value:String.fromCharCode(r)},n.CLEAN=function(r){return r=t.parseText(r),r instanceof Error?r:r.replace(/[\0-\x1F]/g,"")},n.CODE=function(r){return r=t.parseText(r),r instanceof Error?r:r.charCodeAt(0)},n.CONCATENATE=function(){for(var r=u.flatten(arguments),n=0;n<r.length;n++){var e=t.parseText(r[n]);if(e instanceof Error)return e;r[n]=e}return r.join("")},n.DBCS=function(){throw new Error("DBCS is not implemented")},n.DOLLAR=function(r,n){if(n=void 0===n?2:n,r=t.parseNumber(r),r instanceof Error)return r;if(n=t.parseNumber(n),n instanceof Error)return n;var e="";return n<=0?(r=Math.round(r*Math.pow(10,n))/Math.pow(10,n),e="($0,0)"):n>0&&(e="($0,0."+new Array(n+1).join("0")+")"),a(r).format(e)},n.EXACT=function(r,n){return r=t.parseText(r),r instanceof Error?r:(n=t.parseText(n),n instanceof Error?n:r===n)},n.FIND=function(r,n,e){if(e=void 0===e?0:e,r=t.parseText(r),r instanceof Error)return r;if(n=t.parseText(n),n instanceof Error)return n;if(e=t.parseNumber(e),e instanceof Error)return e;if(e<0||e>n.length)return o.value;var a=n.indexOf(r,e-1)+1;return 0===a?o.value:a},n.FIXED=function(r,n,e){if(n=void 0===n?2:n,e=void 0!==e&&e,r=t.parseNumber(r),r instanceof Error)return r;if(n=t.parseNumber(n),n instanceof Error)return n;var o=e?"0":"0,0";return n<=0?r=Math.round(r*Math.pow(10,n))/Math.pow(10,n):n>0&&(o+="."+new Array(n+1).join("0")),a(r).format(o)},n.LEFT=function(r,n){return n=void 0===n?1:n,r=t.parseText(r),r instanceof Error?r:(n=t.parseNumber(n),n instanceof Error?n:n<0?o.value:r.substring(0,n))},n.LEN=function(r){return r=t.parseText(r),r instanceof Error?r:r.length},n.LOWER=function(r){return r=t.parseText(r),r instanceof Error?r:r.toLowerCase()},n.MID=function(r,n,e){return r=t.parseText(r),r instanceof Error?r:(n=t.parseNumber(n),n instanceof Error?n:n<1?o.value:(e=t.parseNumber(e),e instanceof Error?e:e<0?o.value:r.substring(n-1,e)))},n.NUMBERVALUE=function(){throw new Error("NUMBERVALUE is not implemented")},n.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},n.PROPER=function(r){return r=t.parseText(r),r instanceof Error?r:r.replace(/\w\S*/g,function(r){return r.charAt(0).toUpperCase()+r.substr(1).toLowerCase()})},n.REPLACE=function(r,n,e,a){return r=t.parseText(r),r instanceof Error?r:(n=t.parseNumber(n),n instanceof Error?n:n<1?o.value:(e=t.parseNumber(e),e instanceof Error?e:e<0?o.value:(a=t.parseText(a),a instanceof Error?a:r.substr(0,n-1)+a+r.substr(n-1+e))))},n.REPT=function(r,n){return r=t.parseText(r),r instanceof Error?r:(n=t.parseNumber(n),n instanceof Error?n:(n=Math.floor(n),n<0?o.value:new Array(n+1).join(r)))},n.RIGHT=function(r,n){return void 0!==n&&null!==n||(n=1),r=t.parseText(r),r instanceof Error?r:(n=t.parseNumber(n),n instanceof Error?n:n<0?o.value:r.substring(r.length-n))},n.SEARCH=function(r,n,e){if(e=void 0===e?0:e,r=t.parseText(r),r instanceof Error)return r;if(n=t.parseText(n),n instanceof Error)return n;if(e=t.parseNumber(e),e instanceof Error)return e;if(e<0||e>n.length)return o.value;var a=n.toLowerCase().indexOf(r.toLowerCase(),e-1)+1;return 0===a?o.value:a},n.SUBSTITUTE=function(r,n,e,a){if(r=t.parseText(r),r instanceof Error)return r;if(n=t.parseText(n),n instanceof Error)return n;if(e=t.parseText(e),e instanceof Error)return e;if(void 0===a)return r.replace(new RegExp(n,"g"),e);if(a=t.parseNumber(a),a instanceof Error)return a;if(a<1)return o.value;for(var u=1,i=0;u<=a;u++,i++)i=r.indexOf(n,i);return r.substring(0,i-1)+e+r.substring(i-1+n.length)},n.T=function(r){return r instanceof Error?r:"string"==typeof r?r:""},n.TEXT=function(){throw new Error("TEXT is not implemented")},n.TRIM=function(r){return r=t.parseText(r),r instanceof Error?r:r.replace(/ +/g," ").trim()},n.UNICHAR=n.CHAR,n.UNICODE=n.CODE,n.UPPER=function(r){return r instanceof Error?r:r.toUpperCase()},n.VALUE=function(r){return r=t.parseText(r),r instanceof Error?r:a().unformat(r)}},function(r,n,e){var t,o;/*!
	 * numeral.js
	 * version : 1.5.3
	 * author : Adam Draper
	 * license : MIT
	 * http://adamwdraper.github.com/Numeral-js/
	 */
(function(){function e(r){this._value=r}function a(r,n,e,t){var o,a,u=Math.pow(10,n);return a=(e(r*u)/u).toFixed(n),t&&(o=new RegExp("0{1,"+t+"}$"),a=a.replace(o,"")),a}function u(r,n,e){var t;return t=n.indexOf("$")>-1?f(r,n,e):n.indexOf("%")>-1?s(r,n,e):n.indexOf(":")>-1?c(r,n):m(r._value,n,e)}function i(r,n){var e,t,o,a,u,i=n,f=["KB","MB","GB","TB","PB","EB","ZB","YB"],s=!1;if(n.indexOf(":")>-1)r._value=l(n);else if(n===d)r._value=0;else{for("."!==N[b].delimiters.decimal&&(n=n.replace(/\./g,"").replace(N[b].delimiters.decimal,".")),e=new RegExp("[^a-zA-Z]"+N[b].abbreviations.thousand+"(?:\\)|(\\"+N[b].currency.symbol+")?(?:\\))?)?$"),t=new RegExp("[^a-zA-Z]"+N[b].abbreviations.million+"(?:\\)|(\\"+N[b].currency.symbol+")?(?:\\))?)?$"),o=new RegExp("[^a-zA-Z]"+N[b].abbreviations.billion+"(?:\\)|(\\"+N[b].currency.symbol+")?(?:\\))?)?$"),a=new RegExp("[^a-zA-Z]"+N[b].abbreviations.trillion+"(?:\\)|(\\"+N[b].currency.symbol+")?(?:\\))?)?$"),u=0;u<=f.length&&!(s=n.indexOf(f[u])>-1&&Math.pow(1024,u+1));u++);r._value=(s?s:1)*(i.match(e)?Math.pow(10,3):1)*(i.match(t)?Math.pow(10,6):1)*(i.match(o)?Math.pow(10,9):1)*(i.match(a)?Math.pow(10,12):1)*(n.indexOf("%")>-1?.01:1)*((n.split("-").length+Math.min(n.split("(").length-1,n.split(")").length-1))%2?1:-1)*Number(n.replace(/[^0-9\.]+/g,"")),r._value=s?Math.ceil(r._value):r._value}return r._value}function f(r,n,e){var t,o,a=n.indexOf("$"),u=n.indexOf("("),i=n.indexOf("-"),f="";return n.indexOf(" $")>-1?(f=" ",n=n.replace(" $","")):n.indexOf("$ ")>-1?(f=" ",n=n.replace("$ ","")):n=n.replace("$",""),o=m(r._value,n,e),a<=1?o.indexOf("(")>-1||o.indexOf("-")>-1?(o=o.split(""),t=1,(a<u||a<i)&&(t=0),o.splice(t,0,N[b].currency.symbol+f),o=o.join("")):o=N[b].currency.symbol+f+o:o.indexOf(")")>-1?(o=o.split(""),o.splice(-1,0,f+N[b].currency.symbol),o=o.join("")):o=o+f+N[b].currency.symbol,o}function s(r,n,e){var t,o="",a=100*r._value;return n.indexOf(" %")>-1?(o=" ",n=n.replace(" %","")):n=n.replace("%",""),t=m(a,n,e),t.indexOf(")")>-1?(t=t.split(""),t.splice(-1,0,o+"%"),t=t.join("")):t=t+o+"%",t}function c(r){var n=Math.floor(r._value/60/60),e=Math.floor((r._value-60*n*60)/60),t=Math.round(r._value-60*n*60-60*e);return n+":"+(e<10?"0"+e:e)+":"+(t<10?"0"+t:t)}function l(r){var n=r.split(":"),e=0;return 3===n.length?(e+=60*Number(n[0])*60,e+=60*Number(n[1]),e+=Number(n[2])):2===n.length&&(e+=60*Number(n[0]),e+=Number(n[1])),Number(e)}function m(r,n,e){var t,o,u,i,f,s,c=!1,l=!1,m=!1,p="",h=!1,E=!1,v=!1,g=!1,M=!1,I="",T="",A=Math.abs(r),w=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],y="",C=!1;if(0===r&&null!==d)return d;if(n.indexOf("(")>-1?(c=!0,n=n.slice(1,-1)):n.indexOf("+")>-1&&(l=!0,n=n.replace(/\+/g,"")),n.indexOf("a")>-1&&(h=n.indexOf("aK")>=0,E=n.indexOf("aM")>=0,v=n.indexOf("aB")>=0,g=n.indexOf("aT")>=0,M=h||E||v||g,n.indexOf(" a")>-1?(p=" ",n=n.replace(" a","")):n=n.replace("a",""),A>=Math.pow(10,12)&&!M||g?(p+=N[b].abbreviations.trillion,r/=Math.pow(10,12)):A<Math.pow(10,12)&&A>=Math.pow(10,9)&&!M||v?(p+=N[b].abbreviations.billion,r/=Math.pow(10,9)):A<Math.pow(10,9)&&A>=Math.pow(10,6)&&!M||E?(p+=N[b].abbreviations.million,r/=Math.pow(10,6)):(A<Math.pow(10,6)&&A>=Math.pow(10,3)&&!M||h)&&(p+=N[b].abbreviations.thousand,r/=Math.pow(10,3))),n.indexOf("b")>-1)for(n.indexOf(" b")>-1?(I=" ",n=n.replace(" b","")):n=n.replace("b",""),u=0;u<=w.length;u++)if(t=Math.pow(1024,u),o=Math.pow(1024,u+1),r>=t&&r<o){I+=w[u],t>0&&(r/=t);break}return n.indexOf("o")>-1&&(n.indexOf(" o")>-1?(T=" ",n=n.replace(" o","")):n=n.replace("o",""),T+=N[b].ordinal(r)),n.indexOf("[.]")>-1&&(m=!0,n=n.replace("[.]",".")),i=r.toString().split(".")[0],f=n.split(".")[1],s=n.indexOf(","),f?(f.indexOf("[")>-1?(f=f.replace("]",""),f=f.split("["),y=a(r,f[0].length+f[1].length,e,f[1].length)):y=a(r,f.length,e),i=y.split(".")[0],y=y.split(".")[1].length?N[b].delimiters.decimal+y.split(".")[1]:"",m&&0===Number(y.slice(1))&&(y="")):i=a(r,null,e),i.indexOf("-")>-1&&(i=i.slice(1),C=!0),s>-1&&(i=i.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+N[b].delimiters.thousands)),0===n.indexOf(".")&&(i=""),(c&&C?"(":"")+(!c&&C?"-":"")+(!C&&l?"+":"")+i+y+(T?T:"")+(p?p:"")+(I?I:"")+(c&&C?")":"")}function p(r,n){N[r]=n}function h(r){var n=r.toString().split(".");return n.length<2?1:Math.pow(10,n[1].length)}function E(){var r=Array.prototype.slice.call(arguments);return r.reduce(function(r,n){var e=h(r),t=h(n);return e>t?e:t},-(1/0))}var v,g="1.5.3",N={},b="en",d=null,M="0,0",I="undefined"!=typeof r&&r.exports;v=function(r){return v.isNumeral(r)?r=r.value():0===r||"undefined"==typeof r?r=0:Number(r)||(r=v.fn.unformat(r)),new e(Number(r))},v.version=g,v.isNumeral=function(r){return r instanceof e},v.language=function(r,n){if(!r)return b;if(r&&!n){if(!N[r])throw new Error("Unknown language : "+r);b=r}return!n&&N[r]||p(r,n),v},v.languageData=function(r){if(!r)return N[b];if(!N[r])throw new Error("Unknown language : "+r);return N[r]},v.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(r){var n=r%10;return 1===~~(r%100/10)?"th":1===n?"st":2===n?"nd":3===n?"rd":"th"},currency:{symbol:"$"}}),v.zeroFormat=function(r){d="string"==typeof r?r:null},v.defaultFormat=function(r){M="string"==typeof r?r:"0.0"},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(r,n){"use strict";if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof r)throw new TypeError(r+" is not a function");var e,t,o=this.length>>>0,a=!1;for(1<arguments.length&&(t=n,a=!0),e=0;o>e;++e)this.hasOwnProperty(e)&&(a?t=r(t,this[e],e,this):(t=this[e],a=!0));if(!a)throw new TypeError("Reduce of empty array with no initial value");return t}),v.fn=e.prototype={clone:function(){return v(this)},format:function(r,n){return u(this,r?r:M,void 0!==n?n:Math.round)},unformat:function(r){return"[object Number]"===Object.prototype.toString.call(r)?r:i(this,r?r:M)},value:function(){return this._value},valueOf:function(){return this._value},set:function(r){return this._value=Number(r),this},add:function(r){function n(r,n,t,o){return r+e*n}var e=E.call(null,this._value,r);return this._value=[this._value,r].reduce(n,0)/e,this},subtract:function(r){function n(r,n,t,o){return r-e*n}var e=E.call(null,this._value,r);return this._value=[r].reduce(n,this._value*e)/e,this},multiply:function(r){function n(r,n,e,t){var o=E(r,n);return r*o*(n*o)/(o*o)}return this._value=[this._value,r].reduce(n,1),this},divide:function(r){function n(r,n,e,t){var o=E(r,n);return r*o/(n*o)}return this._value=[this._value,r].reduce(n),this},difference:function(r){return Math.abs(v(this._value).subtract(r).value())}},I&&(r.exports=v),"undefined"==typeof ender&&(this.numeral=v),t=[],o=function(){return v}.apply(n,t),!(void 0!==o&&(r.exports=o))}).call(this)},function(r,n){this.j$=this.jStat=function(r,n){function e(n,e){var t=n>e?n:e;return r.pow(10,17-~~(r.log(t>0?t:-t)*r.LOG10E))}function t(r){return"[object Function]"===m.call(r)}function o(r){return"number"==typeof r&&r===r}function a(r){return c.apply([],r)}function u(){return new u._init(arguments)}function i(){return 0}function f(){return 1}function s(r,n){return r===n?1:0}var c=Array.prototype.concat,l=Array.prototype.slice,m=Object.prototype.toString,p=Array.isArray||function(r){return"[object Array]"===m.call(r)};u.fn=u.prototype,u._init=function(r){var n;if(p(r[0]))if(p(r[0][0])){for(t(r[1])&&(r[0]=u.map(r[0],r[1])),n=0;n<r[0].length;n++)this[n]=r[0][n];this.length=r[0].length}else this[0]=t(r[1])?u.map(r[0],r[1]):r[0],this.length=1;else if(o(r[0]))this[0]=u.seq.apply(null,r),this.length=1;else{if(r[0]instanceof u)return u(r[0].toArray());this[0]=[],this.length=1}return this},u._init.prototype=u.prototype,u._init.constructor=u,u.utils={calcRdx:e,isArray:p,isFunction:t,isNumber:o,toVector:a},u.extend=function(r){var n,e;if(1===arguments.length){for(e in r)u[e]=r[e];return this}for(n=1;n<arguments.length;n++)for(e in arguments[n])r[e]=arguments[n][e];return r},u.rows=function(r){return r.length||1},u.cols=function(r){return r[0].length||1},u.dimensions=function(r){return{rows:u.rows(r),cols:u.cols(r)}},u.row=function(r,n){return r[n]},u.col=function(r,n){for(var e=new Array(r.length),t=0;t<r.length;t++)e[t]=[r[t][n]];return e},u.diag=function(r){for(var n=u.rows(r),e=new Array(n),t=0;t<n;t++)e[t]=[r[t][t]];return e},u.antidiag=function(r){for(var n=u.rows(r)-1,e=new Array(n),t=0;n>=0;n--,t++)e[t]=[r[t][n]];return e},u.transpose=function(r){var n,e,t,o,a,u=[];for(p(r[0])||(r=[r]),e=r.length,t=r[0].length,a=0;a<t;a++){for(n=new Array(e),o=0;o<e;o++)n[o]=r[o][a];u.push(n)}return 1===u.length?u[0]:u},u.map=function(r,n,e){var t,o,a,u,i;for(p(r[0])||(r=[r]),o=r.length,a=r[0].length,u=e?r:new Array(o),t=0;t<o;t++)for(u[t]||(u[t]=new Array(a)),i=0;i<a;i++)u[t][i]=n(r[t][i],t,i);return 1===u.length?u[0]:u},u.alter=function(r,n){return u.map(r,n,!0)},u.create=function(r,n,e){var o,a,u=new Array(r);for(t(n)&&(e=n,n=r),o=0;o<r;o++)for(u[o]=new Array(n),a=0;a<n;a++)u[o][a]=e(o,a);return u},u.zeros=function(r,n){return o(n)||(n=r),u.create(r,n,i)},u.ones=function(r,n){return o(n)||(n=r),u.create(r,n,f)},u.rand=function(n,e){return o(e)||(e=n),u.create(n,e,r.random)},u.identity=function(r,n){return o(n)||(n=r),u.create(r,n,s)},u.symmetric=function(r){var n,e,t=r.length;if(r.length!==r[0].length)return!1;for(n=0;n<t;n++)for(e=0;e<t;e++)if(r[e][n]!==r[n][e])return!1;return!0},u.clear=function(r){return u.alter(r,i)},u.seq=function(r,n,o,a){t(a)||(a=!1);var u,i=[],f=e(r,n),s=(n*f-r*f)/((o-1)*f),c=r;for(u=0;c<=n;u++,c=(r*f+s*f*u)/f)i.push(a?a(c,u):c);return i};var h=u.prototype;return h.length=0,h.push=Array.prototype.push,h.sort=Array.prototype.sort,h.splice=Array.prototype.splice,h.slice=Array.prototype.slice,h.toArray=function(){return this.length>1?l.call(this):l.call(this)[0]},h.map=function(r,n){return u(u.map(this,r,n))},h.alter=function(r){return u.alter(this,r),this},function(r){for(var n=0;n<r.length;n++)(function(r){h[r]=function(n){var e,t=this;return n?(setTimeout(function(){n.call(t,h[r].call(t))}),this):(e=u[r](this),p(e)?u(e):e)}})(r[n])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(r){for(var n=0;n<r.length;n++)(function(r){h[r]=function(n,e){var t=this;return e?(setTimeout(function(){e.call(t,h[r].call(t,n))}),this):u(u[r](this,n))}})(r[n])}("row col".split(" ")),function(r){for(var n=0;n<r.length;n++)(function(r){h[r]=new Function("return jStat(jStat."+r+".apply(null, arguments));")})(r[n])}("create zeros ones rand identity".split(" ")),u}(Math),function(r,n){function e(r,n){return r-n}function t(r,e,t){return n.max(e,n.min(r,t))}var o=r.utils.isFunction;r.sum=function r(n){for(var r=0,e=n.length;--e>=0;)r+=n[e];return r},r.sumsqrd=function(r){for(var n=0,e=r.length;--e>=0;)n+=r[e]*r[e];return n},r.sumsqerr=function(n){for(var e,t=r.mean(n),o=0,a=n.length;--a>=0;)e=n[a]-t,o+=e*e;return o},r.product=function(r){for(var n=1,e=r.length;--e>=0;)n*=r[e];return n},r.min=function(r){for(var n=r[0],e=0;++e<r.length;)r[e]<n&&(n=r[e]);return n},r.max=function(r){for(var n=r[0],e=0;++e<r.length;)r[e]>n&&(n=r[e]);return n},r.mean=function(n){return r.sum(n)/n.length},r.meansqerr=function(n){return r.sumsqerr(n)/n.length},r.geomean=function(e){return n.pow(r.product(e),1/e.length)},r.median=function(r){var n=r.length,t=r.slice().sort(e);return 1&n?t[n/2|0]:(t[n/2-1]+t[n/2])/2},r.cumsum=function(r){var n,e=r.length,t=new Array(e);for(t[0]=r[0],n=1;n<e;n++)t[n]=t[n-1]+r[n];return t},r.diff=function(r){var n,e=[],t=r.length;for(n=1;n<t;n++)e.push(r[n]-r[n-1]);return e},r.mode=function(r){var n,t=r.length,o=r.slice().sort(e),a=1,u=0,i=0,f=[];for(n=0;n<t;n++)o[n]===o[n+1]?a++:(a>u?(f=[o[n]],u=a,i=0):a===u&&(f.push(o[n]),i++),a=1);return 0===i?f[0]:f},r.range=function(n){return r.max(n)-r.min(n)},r.variance=function(n,e){return r.sumsqerr(n)/(n.length-(e?1:0))},r.stdev=function(e,t){return n.sqrt(r.variance(e,t))},r.meandev=function(e){var t,o=0,a=r.mean(e);for(t=e.length-1;t>=0;t--)o+=n.abs(e[t]-a);return o/e.length},r.meddev=function(e){var t,o=0,a=r.median(e);for(t=e.length-1;t>=0;t--)o+=n.abs(e[t]-a);return o/e.length},r.coeffvar=function(n){return r.stdev(n)/r.mean(n)},r.quartiles=function(r){var t=r.length,o=r.slice().sort(e);return[o[n.round(t/4)-1],o[n.round(t/2)-1],o[n.round(3*t/4)-1]]},r.quantiles=function(r,o,a,u){var i,f,s,c,l,m,p=r.slice().sort(e),h=[o.length],E=r.length;for("undefined"==typeof a&&(a=3/8),"undefined"==typeof u&&(u=3/8),i=0;i<o.length;i++)f=o[i],s=a+f*(1-a-u),c=E*f+s,l=n.floor(t(c,1,E-1)),m=t(c-l,0,1),h[i]=(1-m)*p[l-1]+m*p[l];return h},r.percentileOfScore=function(r,n,e){var t,o,a=0,u=r.length,i=!1;for("strict"===e&&(i=!0),o=0;o<u;o++)t=r[o],(i&&t<n||!i&&t<=n)&&a++;return a/u},r.covariance=function(n,e){var t,o=r.mean(n),a=r.mean(e),u=n.length,i=new Array(u);for(t=0;t<u;t++)i[t]=(n[t]-o)*(e[t]-a);return r.sum(i)/(u-1)},r.corrcoeff=function(n,e){return r.covariance(n,e)/r.stdev(n,1)/r.stdev(e,1)};var a=r.prototype;a.cumsum=function(n,e){var t=[],u=0,i=this;if(o(n)&&(e=n,n=!1),e)return setTimeout(function(){e.call(i,a.cumsum.call(i,n))}),this;if(this.length>1){for(i=n===!0?this:this.transpose();u<i.length;u++)t[u]=r.cumsum(i[u]);return t}return r.cumsum(this[0],n)},function(n){for(var e=0;e<n.length;e++)(function(n){a[n]=function(e,t){var u=[],i=0,f=this;if(o(e)&&(t=e,e=!1),t)return setTimeout(function(){t.call(f,a[n].call(f,e))}),this;if(this.length>1){for(f=e===!0?this:this.transpose();i<f.length;i++)u[i]=r[n](f[i]);return e===!0?r[n](r.utils.toVector(u)):u}return r[n](this[0],e)}})(n[e])}("sum sumsqrd sumsqerr product min max mean meansqerr geomean median diff mode range variance stdev meandev meddev coeffvar quartiles".split(" ")),function(n){for(var e=0;e<n.length;e++)(function(n){a[n]=function(){var e=[],t=0,u=this,i=Array.prototype.slice.call(arguments);if(o(i[i.length-1])){var f=i[i.length-1],s=i.slice(0,i.length-1);return setTimeout(function(){f.call(u,a[n].apply(u,s))}),this}var f=void 0,c=function(e){return r[n].apply(u,[e].concat(i))};if(this.length>1){for(u=u.transpose();t<u.length;t++)e[t]=c(u[t]);return e}return c(this[0])}})(n[e])}("quantiles percentileOfScore".split(" "))}(this.jStat,Math),function(r,n){r.gammaln=function(r){var e,t,o,a=0,u=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],i=1.000000000190015;for(o=(t=e=r)+5.5,o-=(e+.5)*n.log(o);a<6;a++)i+=u[a]/++t;return n.log(2.5066282746310007*i/e)-o},r.gammafn=function(r){var e,t,o,a,u=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],i=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],f=!1,s=0,c=0,l=0,m=r;if(m<=0){if(a=m%1+3.6e-16,!a)return 1/0;f=(1&m?-1:1)*n.PI/n.sin(n.PI*a),m=1-m}for(o=m,t=m<1?m++:(m-=s=(0|m)-1)-1,e=0;e<8;++e)l=(l+u[e])*t,c=c*t+i[e];if(a=l/c+1,o<m)a/=o;else if(o>m)for(e=0;e<s;++e)a*=m,m++;return f&&(a=f/a),a},r.gammap=function(e,t){var o,a=r.gammaln(e),u=e,i=1/e,f=i,s=t+1-e,c=1/1e-30,l=1/s,m=l,p=1,h=-~(8.5*n.log(e>=1?e:1/e)+.4*e+17);if(t<0||e<=0)return NaN;if(t<e+1){for(;p<=h;p++)i+=f*=t/++u;return i*n.exp(-t+e*n.log(t)-a)}for(;p<=h;p++)o=-p*(p-e),s+=2,l=o*l+s,c=s+o/c,l=1/l,m*=l*c;return 1-m*n.exp(-t+e*n.log(t)-a)},r.factorialln=function(n){return n<0?NaN:r.gammaln(n+1)},r.factorial=function(n){return n<0?NaN:r.gammafn(n+1)},r.combination=function(e,t){return e>170||t>170?n.exp(r.combinationln(e,t)):r.factorial(e)/r.factorial(t)/r.factorial(e-t)},r.combinationln=function(n,e){return r.factorialln(n)-r.factorialln(e)-r.factorialln(n-e)},r.permutation=function(n,e){return r.factorial(n)/r.factorial(n-e)},r.betafn=function(e,t){if(!(e<=0||t<=0))return e+t>170?n.exp(r.betaln(e,t)):r.gammafn(e)*r.gammafn(t)/r.gammafn(e+t)},r.betaln=function(n,e){return r.gammaln(n)+r.gammaln(e)-r.gammaln(n+e)},r.betacf=function(r,e,t){var o,a,u,i,f=1e-30,s=1,c=e+t,l=e+1,m=e-1,p=1,h=1-c*r/l;for(n.abs(h)<f&&(h=f),h=1/h,i=h;s<=100&&(o=2*s,a=s*(t-s)*r/((m+o)*(e+o)),h=1+a*h,n.abs(h)<f&&(h=f),p=1+a/p,n.abs(p)<f&&(p=f),h=1/h,i*=h*p,a=-(e+s)*(c+s)*r/((e+o)*(l+o)),h=1+a*h,n.abs(h)<f&&(h=f),p=1+a/p,n.abs(p)<f&&(p=f),h=1/h,u=h*p,i*=u,!(n.abs(u-1)<3e-7));s++);return i},r.gammapinv=function(e,t){var o,a,u,i,f,s,c,l=0,m=t-1,p=1e-8,h=r.gammaln(t);if(e>=1)return n.max(100,t+100*n.sqrt(t));if(e<=0)return 0;for(t>1?(s=n.log(m),c=n.exp(m*(s-1)-h),f=e<.5?e:1-e,u=n.sqrt(-2*n.log(f)),o=(2.30753+.27061*u)/(1+u*(.99229+.04481*u))-u,e<.5&&(o=-o),o=n.max(.001,t*n.pow(1-1/(9*t)-o/(3*n.sqrt(t)),3))):(u=1-t*(.253+.12*t),o=e<u?n.pow(e/u,1/t):1-n.log(1-(e-u)/(1-u)));l<12;l++){if(o<=0)return 0;if(a=r.gammap(t,o)-e,u=t>1?c*n.exp(-(o-m)+m*(n.log(o)-s)):n.exp(-o+m*n.log(o)-h),i=a/u,o-=u=i/(1-.5*n.min(1,i*((t-1)/o-1))),o<=0&&(o=.5*(o+u)),n.abs(u)<p*o)break}return o},r.erf=function(r){var e,t,o,a,u=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,9.6467911e-11,2.394038e-12,-6.886027e-12,8.94487e-13,3.13092e-13,-1.12708e-13,3.81e-16,7.106e-15,-1.523e-15,-9.4e-17,1.21e-16,-2.8e-17],i=u.length-1,f=!1,s=0,c=0;for(r<0&&(r=-r,f=!0),e=2/(2+r),t=4*e-2;i>0;i--)o=s,s=t*s-c+u[i],c=o;return a=e*n.exp(-r*r+.5*(u[0]+t*s)-c),f?a-1:1-a},r.erfc=function(n){return 1-r.erf(n)},r.erfcinv=function(e){var t,o,a,u,i=0;if(e>=2)return-100;if(e<=0)return 100;for(u=e<1?e:2-e,a=n.sqrt(-2*n.log(u/2)),t=-.70711*((2.30753+.27061*a)/(1+a*(.99229+.04481*a))-a);i<2;i++)o=r.erfc(t)-u,t+=o/(1.1283791670955126*n.exp(-t*t)-t*o);return e<1?t:-t},r.ibetainv=function(e,t,o){var a,u,i,f,s,c,l,m,p,h,E,v=1e-8,g=t-1,N=o-1,b=0;if(e<=0)return 0;if(e>=1)return 1;for(t>=1&&o>=1?(i=e<.5?e:1-e,f=n.sqrt(-2*n.log(i)),l=(2.30753+.27061*f)/(1+f*(.99229+.04481*f))-f,e<.5&&(l=-l),m=(l*l-3)/6,p=2/(1/(2*t-1)+1/(2*o-1)),h=l*n.sqrt(m+p)/p-(1/(2*o-1)-1/(2*t-1))*(m+5/6-2/(3*p)),l=t/(t+o*n.exp(2*h))):(a=n.log(t/(t+o)),u=n.log(o/(t+o)),f=n.exp(t*a)/t,s=n.exp(o*u)/o,h=f+s,l=e<f/h?n.pow(t*h*e,1/t):1-n.pow(o*h*(1-e),1/o)),E=-r.gammaln(t)-r.gammaln(o)+r.gammaln(t+o);b<10;b++){if(0===l||1===l)return l;if(c=r.ibeta(l,t,o)-e,f=n.exp(g*n.log(l)+N*n.log(1-l)+E),s=c/f,l-=f=s/(1-.5*n.min(1,s*(g/l-N/(1-l)))),l<=0&&(l=.5*(l+f)),l>=1&&(l=.5*(l+f+1)),n.abs(f)<v*l&&b>0)break}return l},r.ibeta=function(e,t,o){var a=0===e||1===e?0:n.exp(r.gammaln(t+o)-r.gammaln(t)-r.gammaln(o)+t*n.log(e)+o*n.log(1-e));return!(e<0||e>1)&&(e<(t+1)/(t+o+2)?a*r.betacf(e,t,o)/t:1-a*r.betacf(1-e,o,t)/o)},r.randn=function(e,t){var o,a,u,i,f;if(t||(t=e),e)return r.create(e,t,function(){return r.randn()});do o=n.random(),a=1.7156*(n.random()-.5),u=o-.449871,i=n.abs(a)+.386595,f=u*u+i*(.196*i-.25472*u);while(f>.27597&&(f>.27846||a*a>-4*n.log(o)*o*o));return a/o},r.randg=function(e,t,o){var a,u,i,f,s,c,l=e;if(o||(o=t),e||(e=1),t)return c=r.zeros(t,o),c.alter(function(){return r.randg(e)}),c;e<1&&(e+=1),a=e-1/3,u=1/n.sqrt(9*a);do{do s=r.randn(),f=1+u*s;while(f<=0);f*=f*f,i=n.random()}while(i>1-.331*n.pow(s,4)&&n.log(i)>.5*s*s+a*(1-f+n.log(f)));if(e==l)return a*f;do i=n.random();while(0===i);return n.pow(i,1/l)*a*f},function(n){for(var e=0;e<n.length;e++)(function(n){r.fn[n]=function(){return r(r.map(this,function(e){return r[n](e)}))}})(n[e])}("gammaln gammafn factorial factorialln".split(" ")),function(n){for(var e=0;e<n.length;e++)(function(n){r.fn[n]=function(){return r(r[n].apply(null,arguments))}})(n[e])}("randn".split(" "))}(this.jStat,Math),function(r,n){!function(n){for(var e=0;e<n.length;e++)(function(n){r[n]=function(r,n,e){return this instanceof arguments.callee?(this._a=r,this._b=n,this._c=e,this):new arguments.callee(r,n,e)},r.fn[n]=function(e,t,o){var a=r[n](e,t,o);return a.data=this,a},r[n].prototype.sample=function(e){var t=this._a,o=this._b,a=this._c;return e?r.alter(e,function(){return r[n].sample(t,o,a)}):r[n].sample(t,o,a)},function(e){for(var t=0;t<e.length;t++)(function(e){r[n].prototype[e]=function(t){var o=this._a,a=this._b,u=this._c;return t||0===t||(t=this.data),"number"!=typeof t?r.fn.map.call(t,function(t){return r[n][e](t,o,a,u)}):r[n][e](t,o,a,u)}})(e[t])}("pdf cdf inv".split(" ")),function(e){for(var t=0;t<e.length;t++)(function(e){r[n].prototype[e]=function(){return r[n][e](this._a,this._b,this._c)}})(e[t])}("mean median mode variance".split(" "))})(n[e])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy lognormal normal pareto studentt weibull uniform  binomial negbin hypgeom poisson triangular".split(" ")),r.extend(r.beta,{pdf:function(e,t,o){return e>1||e<0?0:1==t&&1==o?1:t<512||o<512?n.pow(e,t-1)*n.pow(1-e,o-1)/r.betafn(t,o):n.exp((t-1)*n.log(e)+(o-1)*n.log(1-e)-r.betaln(t,o))},cdf:function(n,e,t){return n>1||n<0?1*(n>1):r.ibeta(n,e,t)},inv:function(n,e,t){return r.ibetainv(n,e,t)},mean:function(r,n){return r/(r+n)},median:function(r,n){throw new Error("median not yet implemented")},mode:function(r,e){return r*e/(n.pow(r+e,2)*(r+e+1))},sample:function(n,e){var t=r.randg(n);return t/(t+r.randg(e))},variance:function(r,e){return r*e/(n.pow(r+e,2)*(r+e+1))}}),r.extend(r.centralF,{pdf:function(e,t,o){if(!(e<0))return n.sqrt(n.pow(t*e,t)*n.pow(o,o)/n.pow(t*e+o,t+o))/(e*r.betafn(t/2,o/2))},cdf:function(n,e,t){return r.ibeta(e*n/(e*n+t),e/2,t/2)},inv:function(n,e,t){return t/(e*(1/r.ibetainv(n,e/2,t/2)-1))},mean:function(r,n){return n>2?n/(n-2):void 0},mode:function(r,n){return r>2?n*(r-2)/(r*(n+2)):void 0},sample:function(n,e){var t=2*r.randg(n/2),o=2*r.randg(e/2);return t/n/(o/e)},variance:function(r,n){if(!(n<=4))return 2*n*n*(r+n-2)/(r*(n-2)*(n-2)*(n-4))}}),r.extend(r.cauchy,{pdf:function(r,e,t){return t/(n.pow(r-e,2)+n.pow(t,2))/n.PI},cdf:function(r,e,t){return n.atan((r-e)/t)/n.PI+.5},inv:function(r,e,t){return e+t*n.tan(n.PI*(r-.5))},median:function(r,n){return r},mode:function(r,n){return r},sample:function(e,t){return r.randn()*n.sqrt(1/(2*r.randg(.5)))*t+e}}),r.extend(r.chisquare,{pdf:function(e,t){return n.exp((t/2-1)*n.log(e)-e/2-t/2*n.log(2)-r.gammaln(t/2))},cdf:function(n,e){return r.gammap(e/2,n/2)},inv:function(n,e){return 2*r.gammapinv(n,.5*e)},mean:function(r){return r},median:function(r){return r*n.pow(1-2/(9*r),3)},mode:function(r){return r-2>0?r-2:0},sample:function(n){return 2*r.randg(n/2)},variance:function(r){return 2*r}}),r.extend(r.exponential,{pdf:function(r,e){return r<0?0:e*n.exp(-e*r)},cdf:function(r,e){return r<0?0:1-n.exp(-e*r)},inv:function(r,e){return-n.log(1-r)/e},mean:function(r){return 1/r},median:function(r){return 1/r*n.log(2)},mode:function(r){return 0},sample:function(r){return-1/r*n.log(n.random())},variance:function(r){return n.pow(r,-2)}}),r.extend(r.gamma,{pdf:function(e,t,o){return n.exp((t-1)*n.log(e)-e/o-r.gammaln(t)-t*n.log(o))},cdf:function(n,e,t){return r.gammap(e,n/t)},inv:function(n,e,t){return r.gammapinv(n,e)*t},mean:function(r,n){return r*n},mode:function(r,n){if(r>1)return(r-1)*n},sample:function(n,e){return r.randg(n)*e},variance:function(r,n){return r*n*n}}),r.extend(r.invgamma,{pdf:function(e,t,o){return n.exp(-(t+1)*n.log(e)-o/e-r.gammaln(t)+t*n.log(o))},cdf:function(n,e,t){return 1-r.gammap(e,t/n)},inv:function(n,e,t){return t/r.gammapinv(1-n,e)},mean:function(r,n){return r>1?n/(r-1):void 0},mode:function(r,n){return n/(r+1)},sample:function(n,e){return e/r.randg(n)},variance:function(r,n){if(!(r<=2))return n*n/((r-1)*(r-1)*(r-2))}}),r.extend(r.kumaraswamy,{pdf:function(r,e,t){return n.exp(n.log(e)+n.log(t)+(e-1)*n.log(r)+(t-1)*n.log(1-n.pow(r,e)))},cdf:function(r,e,t){return 1-n.pow(1-n.pow(r,e),t)},mean:function(n,e){return e*r.gammafn(1+1/n)*r.gammafn(e)/r.gammafn(1+1/n+e)},median:function(r,e){return n.pow(1-n.pow(2,-1/e),1/r)},mode:function(r,e){if(r>=1&&e>=1&&1!==r&&1!==e)return n.pow((r-1)/(r*e-1),1/r)},variance:function(r,n){throw new Error("variance not yet implemented")}}),r.extend(r.lognormal,{pdf:function(r,e,t){return n.exp(-n.log(r)-.5*n.log(2*n.PI)-n.log(t)-n.pow(n.log(r)-e,2)/(2*t*t))},cdf:function(e,t,o){return.5+.5*r.erf((n.log(e)-t)/n.sqrt(2*o*o))},inv:function(e,t,o){return n.exp(-1.4142135623730951*o*r.erfcinv(2*e)+t)},mean:function(r,e){return n.exp(r+e*e/2)},median:function(r,e){return n.exp(r)},mode:function(r,e){return n.exp(r-e*e)},sample:function(e,t){return n.exp(r.randn()*t+e)},variance:function(r,e){return(n.exp(e*e)-1)*n.exp(2*r+e*e)}}),r.extend(r.normal,{pdf:function(r,e,t){return n.exp(-.5*n.log(2*n.PI)-n.log(t)-n.pow(r-e,2)/(2*t*t))},cdf:function(e,t,o){return.5*(1+r.erf((e-t)/n.sqrt(2*o*o)))},inv:function(n,e,t){return-1.4142135623730951*t*r.erfcinv(2*n)+e},mean:function(r,n){return r},median:function(r,n){return r},mode:function(r,n){return r},sample:function(n,e){return r.randn()*e+n},variance:function(r,n){return n*n}}),r.extend(r.pareto,{pdf:function(r,e,t){if(!(r<=e))return t*n.pow(e,t)/n.pow(r,t+1)},cdf:function(r,e,t){return 1-n.pow(e/r,t)},mean:function(r,e){if(!(e<=1))return e*n.pow(r,e)/(e-1)},median:function(r,e){return r*(e*n.SQRT2)},mode:function(r,n){return r},variance:function(r,e){if(!(e<=2))return r*r*e/(n.pow(e-1,2)*(e-2))}}),r.extend(r.studentt,{pdf:function(e,t){return r.gammafn((t+1)/2)/(n.sqrt(t*n.PI)*r.gammafn(t/2))*n.pow(1+e*e/t,-((t+1)/2))},cdf:function(e,t){var o=t/2;return r.ibeta((e+n.sqrt(e*e+t))/(2*n.sqrt(e*e+t)),o,o)},inv:function(e,t){var o=r.ibetainv(2*n.min(e,1-e),.5*t,.5);return o=n.sqrt(t*(1-o)/o),e>.5?o:-o},mean:function(r){return r>1?0:void 0},median:function(r){return 0},mode:function(r){return 0},sample:function(e){return r.randn()*n.sqrt(e/(2*r.randg(e/2)))},variance:function(r){return r>2?r/(r-2):r>1?1/0:void 0}}),r.extend(r.weibull,{pdf:function(r,e,t){return r<0?0:t/e*n.pow(r/e,t-1)*n.exp(-n.pow(r/e,t))},cdf:function(r,e,t){return r<0?0:1-n.exp(-n.pow(r/e,t))},inv:function(r,e,t){return e*n.pow(-n.log(1-r),1/t)},mean:function(n,e){return n*r.gammafn(1+1/e)},median:function(r,e){return r*n.pow(n.log(2),1/e)},mode:function(r,e){if(!(e<=1))return r*n.pow((e-1)/e,1/e)},sample:function(r,e){return r*n.pow(-n.log(n.random()),1/e)},variance:function(e,t){return e*e*r.gammafn(1+2/t)-n.pow(this.mean(e,t),2)}}),r.extend(r.uniform,{pdf:function(r,n,e){return r<n||r>e?0:1/(e-n)},cdf:function(r,n,e){return r<n?0:r<e?(r-n)/(e-n):1},mean:function(r,n){return.5*(r+n)},median:function(n,e){return r.mean(n,e)},mode:function(r,n){throw new Error("mode is not yet implemented")},sample:function(r,e){return r/2+e/2+(e/2-r/2)*(2*n.random()-1)},variance:function(r,e){return n.pow(e-r,2)/12}}),r.extend(r.binomial,{pdf:function(e,t,o){return 0===o||1===o?t*o===e?1:0:r.combination(t,e)*n.pow(o,e)*n.pow(1-o,t-e)},cdf:function(n,e,t){var o=[],a=0;if(n<0)return 0;if(n<e){for(;a<=n;a++)o[a]=r.binomial.pdf(a,e,t);return r.sum(o)}return 1}}),r.extend(r.negbin,{pdf:function(e,t,o){return!(e!==e|0)&&(e<0?0:r.combination(e+t-1,t-1)*n.pow(1-o,e)*n.pow(o,t))},cdf:function(n,e,t){var o=0,a=0;if(n<0)return 0;for(;a<=n;a++)o+=r.negbin.pdf(a,e,t);return o}}),r.extend(r.hypgeom,{pdf:function(e,t,o,a){if(e!==e|0)return!1;if(e<0||e<o-(t-a))return 0;if(e>a||e>o)return 0;if(2*o>t)return 2*a>t?r.hypgeom.pdf(t-o-a+e,t,t-o,t-a):r.hypgeom.pdf(a-e,t,t-o,a);if(2*a>t)return r.hypgeom.pdf(o-e,t,o,t-a);if(o<a)return r.hypgeom.pdf(e,t,a,o);for(var u=1,i=0,f=0;f<e;f++){for(;u>1&&i<a;)u*=1-o/(t-i),i++;u*=(a-f)*(o-f)/((f+1)*(t-o-a+f+1))}for(;i<a;i++)u*=1-o/(t-i);return n.min(1,n.max(0,u))},cdf:function(e,t,o,a){if(e<0||e<o-(t-a))return 0;if(e>=a||e>=o)return 1;if(2*o>t)return 2*a>t?r.hypgeom.cdf(t-o-a+e,t,t-o,t-a):1-r.hypgeom.cdf(a-e-1,t,t-o,a);if(2*a>t)return 1-r.hypgeom.cdf(o-e-1,t,o,t-a);if(o<a)return r.hypgeom.cdf(e,t,a,o);for(var u=1,i=1,f=0,s=0;s<e;s++){for(;u>1&&f<a;){var c=1-o/(t-f);i*=c,u*=c,f++}i*=(a-s)*(o-s)/((s+1)*(t-o-a+s+1)),u+=i}for(;f<a;f++)u*=1-o/(t-f);return n.min(1,n.max(0,u))}}),r.extend(r.poisson,{pdf:function(e,t){return n.pow(t,e)*n.exp(-t)/r.factorial(e)},cdf:function(n,e){var t=[],o=0;if(n<0)return 0;for(;o<=n;o++)t.push(r.poisson.pdf(o,e));return r.sum(t)},mean:function(r){return r},variance:function(r){return r},sample:function(r){var e=1,t=0,o=n.exp(-r);do t++,e*=n.random();while(e>o);return t-1}}),r.extend(r.triangular,{pdf:function(r,n,e,t){return e<=n||t<n||t>e?void 0:r<n||r>e?0:r<=t?2*(r-n)/((e-n)*(t-n)):2*(e-r)/((e-n)*(e-t))},cdf:function(r,e,t,o){if(!(t<=e||o<e||o>t))return r<e?0:r<=o?n.pow(r-e,2)/((t-e)*(o-e)):1-n.pow(t-r,2)/((t-e)*(t-o))},mean:function(r,n,e){return(r+n+e)/3},median:function(r,e,t){return t<=(r+e)/2?e-n.sqrt((e-r)*(e-t))/n.sqrt(2):t>(r+e)/2?r+n.sqrt((e-r)*(t-r))/n.sqrt(2):void 0},mode:function(r,n,e){return e},sample:function(r,e,t){var o=n.random();return o<(t-r)/(e-r)?r+n.sqrt(o*(e-r)*(t-r)):e-n.sqrt((1-o)*(e-r)*(e-t))},variance:function(r,n,e){return(r*r+n*n+e*e-r*n-r*e-n*e)/18}})}(this.jStat,Math),function(r,n){var e=Array.prototype.push,t=r.utils.isArray;r.extend({add:function(n,e){return t(e)?(t(e[0])||(e=[e]),r.map(n,function(r,n,t){return r+e[n][t]})):r.map(n,function(r){return r+e})},subtract:function(n,e){return t(e)?(t(e[0])||(e=[e]),r.map(n,function(r,n,t){return r-e[n][t]||0})):r.map(n,function(r){return r-e})},divide:function(n,e){return t(e)?(t(e[0])||(e=[e]),r.multiply(n,r.inv(e))):r.map(n,function(r){return r/e})},multiply:function(n,e){var o,a,u,i,f=n.length,s=n[0].length,c=r.zeros(f,u=t(e)?e[0].length:s),l=0;if(t(e)){for(;l<u;l++)for(o=0;o<f;o++){for(i=0,a=0;a<s;a++)i+=n[o][a]*e[a][l];c[o][l]=i}return 1===f&&1===l?c[0][0]:c}return r.map(n,function(r){return r*e})},dot:function(n,e){t(n[0])||(n=[n]),t(e[0])||(e=[e]);for(var o,a,u=1===n[0].length&&1!==n.length?r.transpose(n):n,i=1===e[0].length&&1!==e.length?r.transpose(e):e,f=[],s=0,c=u.length,l=u[0].length;s<c;s++){for(f[s]=[],o=0,a=0;a<l;a++)o+=u[s][a]*i[s][a];f[s]=o}return 1===f.length?f[0]:f},pow:function(e,t){return r.map(e,function(r){return n.pow(r,t)})},abs:function(e){return r.map(e,function(r){return n.abs(r)})},norm:function(r,e){var o=0,a=0;for(isNaN(e)&&(e=2),t(r[0])&&(r=r[0]);a<r.length;a++)o+=n.pow(n.abs(r[a]),e);return n.pow(o,1/e)},angle:function(e,t){return n.acos(r.dot(e,t)/(r.norm(e)*r.norm(t)))},aug:function(r,n){for(var t=r.slice(),o=0;o<t.length;o++)e.apply(t[o],n[o]);return t},inv:function(n){for(var e,t=n.length,o=n[0].length,a=r.identity(t,o),u=r.gauss_jordan(n,a),i=[],f=0;f<t;f++)for(i[f]=[],e=o-1;e<u[0].length;e++)i[f][e-o]=u[f][e];return i},det:function(r){var n,e=r.length,t=2*e,o=new Array(t),a=e-1,u=t-1,i=a-e+1,f=u,s=0,c=0;if(2===e)return r[0][0]*r[1][1]-r[0][1]*r[1][0];for(;s<t;s++)o[s]=1;for(s=0;s<e;s++){for(n=0;n<e;n++)o[i<0?i+e:i]*=r[s][n],o[f<e?f+e:f]*=r[s][n],i++,f--;i=--a-e+1,f=--u}for(s=0;s<e;s++)c+=o[s];for(;s<t;s++)c-=o[s];return c},gauss_elimination:function(e,t){var o,a,u,i,f=0,s=0,c=e.length,l=e[0].length,m=1,p=0,h=[];for(e=r.aug(e,t),o=e[0].length;f<c;f++){for(a=e[f][f],s=f,i=f+1;i<l;i++)a<n.abs(e[i][f])&&(a=e[i][f],s=i);if(s!=f)for(i=0;i<o;i++)u=e[f][i],e[f][i]=e[s][i],e[s][i]=u;for(s=f+1;s<c;s++)for(m=e[s][f]/e[f][f],i=f;i<o;i++)e[s][i]=e[s][i]-m*e[f][i]}for(f=c-1;f>=0;f--){for(p=0,s=f+1;s<=c-1;s++)p=h[s]*e[f][s];h[f]=(e[f][o-1]-p)/e[f][f]}return h},gauss_jordan:function(e,t){for(var o=r.aug(e,t),a=o.length,u=o[0].length,i=0;i<a;i++){for(var f=i,s=i+1;s<a;s++)n.abs(o[s][i])>n.abs(o[f][i])&&(f=s);var l=o[i];o[i]=o[f],o[f]=l;for(var s=i+1;s<a;s++){c=o[s][i]/o[i][i];for(var m=i;m<u;m++)o[s][m]-=o[i][m]*c}}for(var i=a-1;i>=0;i--){c=o[i][i];for(var s=0;s<i;s++)for(var m=u-1;m>i-1;m--)o[s][m]-=o[i][m]*o[s][i]/c;o[i][i]/=c;for(var m=a;m<u;m++)o[i][m]/=c}return o},lu:function(r,n){throw new Error("lu not yet implemented")},cholesky:function(r,n){throw new Error("cholesky not yet implemented")},gauss_jacobi:function(e,t,o,a){for(var u,i,f,s,c=0,l=0,m=e.length,p=[],h=[],E=[];c<m;c++)for(p[c]=[],h[c]=[],E[c]=[],l=0;l<m;l++)c>l?(p[c][l]=e[c][l],h[c][l]=E[c][l]=0):c<l?(h[c][l]=e[c][l],p[c][l]=E[c][l]=0):(E[c][l]=e[c][l],
p[c][l]=h[c][l]=0);for(f=r.multiply(r.multiply(r.inv(E),r.add(p,h)),-1),i=r.multiply(r.inv(E),t),u=o,s=r.add(r.multiply(f,o),i),c=2;n.abs(r.norm(r.subtract(s,u)))>a;)u=s,s=r.add(r.multiply(f,u),i),c++;return s},gauss_seidel:function(e,t,o,a){for(var u,i,f,s,c,l=0,m=e.length,p=[],h=[],E=[];l<m;l++)for(p[l]=[],h[l]=[],E[l]=[],u=0;u<m;u++)l>u?(p[l][u]=e[l][u],h[l][u]=E[l][u]=0):l<u?(h[l][u]=e[l][u],p[l][u]=E[l][u]=0):(E[l][u]=e[l][u],p[l][u]=h[l][u]=0);for(s=r.multiply(r.multiply(r.inv(r.add(E,p)),h),-1),f=r.multiply(r.inv(r.add(E,p)),t),i=o,c=r.add(r.multiply(s,o),f),l=2;n.abs(r.norm(r.subtract(c,i)))>a;)i=c,c=r.add(r.multiply(s,i),f),l+=1;return c},SOR:function(e,t,o,a,u){for(var i,f,s,c,l,m=0,p=e.length,h=[],E=[],v=[];m<p;m++)for(h[m]=[],E[m]=[],v[m]=[],i=0;i<p;i++)m>i?(h[m][i]=e[m][i],E[m][i]=v[m][i]=0):m<i?(E[m][i]=e[m][i],h[m][i]=v[m][i]=0):(v[m][i]=e[m][i],h[m][i]=E[m][i]=0);for(c=r.multiply(r.inv(r.add(v,r.multiply(h,u))),r.subtract(r.multiply(v,1-u),r.multiply(E,u))),s=r.multiply(r.multiply(r.inv(r.add(v,r.multiply(h,u))),t),u),f=o,l=r.add(r.multiply(c,o),s),m=2;n.abs(r.norm(r.subtract(l,f)))>a;)f=l,l=r.add(r.multiply(c,f),s),m++;return l},householder:function(e){for(var t,o,a,u,i,f=e.length,s=e[0].length,c=0,l=[],m=[];c<f-1;c++){for(t=0,u=c+1;u<s;u++)t+=e[u][c]*e[u][c];for(i=e[c+1][c]>0?-1:1,t=i*n.sqrt(t),o=n.sqrt((t*t-e[c+1][c]*t)/2),l=r.zeros(f,1),l[c+1][0]=(e[c+1][c]-t)/(2*o),a=c+2;a<f;a++)l[a][0]=e[a][c]/(2*o);m=r.subtract(r.identity(f,s),r.multiply(r.multiply(l,r.transpose(l)),2)),e=r.multiply(m,r.multiply(e,m))}return e},QR:function(e,t){for(var o,a,u,i,f,s,c=e.length,l=e[0].length,m=0,p=[],h=[],E=[];m<c-1;m++){for(a=0,o=m+1;o<l;o++)a+=e[o][m]*e[o][m];for(f=e[m+1][m]>0?-1:1,a=f*n.sqrt(a),u=n.sqrt((a*a-e[m+1][m]*a)/2),p=r.zeros(c,1),p[m+1][0]=(e[m+1][m]-a)/(2*u),i=m+2;i<c;i++)p[i][0]=e[i][m]/(2*u);h=r.subtract(r.identity(c,l),r.multiply(r.multiply(p,r.transpose(p)),2)),e=r.multiply(h,e),t=r.multiply(h,t)}for(m=c-1;m>=0;m--){for(s=0,o=m+1;o<=l-1;o++)s=E[o]*e[m][o];E[m]=t[m][0]/e[m][m]}return E},jacobi:function(e){for(var t,o,a,u,i,f,s,c,l=1,m=0,p=e.length,h=r.identity(p,p),E=[];1===l;){for(m++,f=e[0][1],u=0,i=1,o=0;o<p;o++)for(a=0;a<p;a++)o!=a&&f<n.abs(e[o][a])&&(f=n.abs(e[o][a]),u=o,i=a);for(s=e[u][u]===e[i][i]?e[u][i]>0?n.PI/4:-n.PI/4:n.atan(2*e[u][i]/(e[u][u]-e[i][i]))/2,c=r.identity(p,p),c[u][u]=n.cos(s),c[u][i]=-n.sin(s),c[i][u]=n.sin(s),c[i][i]=n.cos(s),h=r.multiply(h,c),t=r.multiply(r.multiply(r.inv(c),e),c),e=t,l=0,o=1;o<p;o++)for(a=1;a<p;a++)o!=a&&n.abs(e[o][a])>.001&&(l=1)}for(o=0;o<p;o++)E.push(e[o][o]);return[h,E]},rungekutta:function(r,n,e,t,o,a){var u,i,f,s,c;if(2===a)for(;t<=e;)u=n*r(t,o),i=n*r(t+n,o+u),f=o+(u+i)/2,o=f,t+=n;if(4===a)for(;t<=e;)u=n*r(t,o),i=n*r(t+n/2,o+u/2),s=n*r(t+n/2,o+i/2),c=n*r(t+n,o+s),f=o+(u+2*i+2*s+c)/6,o=f,t+=n;return o},romberg:function(r,e,t,o){for(var a,u,i,f,s,c=0,l=(t-e)/2,m=[],p=[],h=[];c<o/2;){for(s=r(e),i=e,f=0;i<=t;i+=l,f++)m[f]=i;for(a=m.length,i=1;i<a-1;i++)s+=(i%2!==0?4:2)*r(m[i]);s=l/3*(s+r(t)),h[c]=s,l/=2,c++}for(u=h.length,a=1;1!==u;){for(i=0;i<u-1;i++)p[i]=(n.pow(4,a)*h[i+1]-h[i])/(n.pow(4,a)-1);u=p.length,h=p,p=[],a++}return h},richardson:function(r,e,t,o){function a(r,n){for(var e,t=0,o=r.length;t<o;t++)r[t]===n&&(e=t);return e}for(var u,i,f,s,c,l=(r.length,n.abs(t-r[a(r,t)+1])),m=0,p=[],h=[];o>=l;)u=a(r,t+o),i=a(r,t),p[m]=(e[u]-2*e[i]+e[2*i-u])/(o*o),o/=2,m++;for(s=p.length,f=1;1!=s;){for(c=0;c<s-1;c++)h[c]=(n.pow(4,f)*p[c+1]-p[c])/(n.pow(4,f)-1);s=h.length,p=h,h=[],f++}return p},simpson:function(r,n,e,t){for(var o,a=(e-n)/t,u=r(n),i=[],f=n,s=0,c=1;f<=e;f+=a,s++)i[s]=f;for(o=i.length;c<o-1;c++)u+=(c%2!==0?4:2)*r(i[c]);return a/3*(u+r(e))},hermite:function(r,n,e,t){for(var o,a=r.length,u=0,i=0,f=[],s=[],c=[],l=[];i<a;i++){for(f[i]=1,o=0;o<a;o++)i!=o&&(f[i]*=(t-r[o])/(r[i]-r[o]));for(s[i]=0,o=0;o<a;o++)i!=o&&(s[i]+=1/(r[i]-r[o]));c[i]=(1-2*(t-r[i])*s[i])*(f[i]*f[i]),l[i]=(t-r[i])*(f[i]*f[i]),u+=c[i]*n[i]+l[i]*e[i]}return u},lagrange:function(r,n,e){for(var t,o,a=0,u=0,i=r.length;u<i;u++){for(o=n[u],t=0;t<i;t++)u!=t&&(o*=(e-r[t])/(r[u]-r[t]));a+=o}return a},cubic_spline:function(n,e,t){for(var o,a=n.length,u=0,i=[],f=[],s=[],c=[],l=[],m=[],p=[];u<a-1;u++)l[u]=n[u+1]-n[u];for(s[0]=0,u=1;u<a-1;u++)s[u]=3/l[u]*(e[u+1]-e[u])-3/l[u-1]*(e[u]-e[u-1]);for(u=1;u<a-1;u++)i[u]=[],f[u]=[],i[u][u-1]=l[u-1],i[u][u]=2*(l[u-1]+l[u]),i[u][u+1]=l[u],f[u][0]=s[u];for(c=r.multiply(r.inv(i),f),o=0;o<a-1;o++)m[o]=(e[o+1]-e[o])/l[o]-l[o]*(c[o+1][0]+2*c[o][0])/3,p[o]=(c[o+1][0]-c[o][0])/(3*l[o]);for(o=0;o<a&&!(n[o]>t);o++);return o-=1,e[o]+(t-n[o])*m[o]+r.sq(t-n[o])*c[o]+(t-n[o])*r.sq(t-n[o])*p[o]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(n){var e,t,o=n.length,a=n[0].length,u=0,i=[],f=[],s=[],c=[],l=[],m=[],p=[],h=[],E=[],v=[];for(u=0;u<o;u++)i[u]=r.sum(n[u])/a;for(u=0;u<a;u++)for(p[u]=[],e=0;e<o;e++)p[u][e]=n[e][u]-i[e];for(p=r.transpose(p),u=0;u<o;u++)for(h[u]=[],e=0;e<o;e++)h[u][e]=r.dot([p[u]],[p[e]])/(a-1);for(s=r.jacobi(h),E=s[0],f=s[1],v=r.transpose(E),u=0;u<f.length;u++)for(e=u;e<f.length;e++)f[u]<f[e]&&(t=f[u],f[u]=f[e],f[e]=t,c=v[u],v[u]=v[e],v[e]=c);for(m=r.transpose(p),u=0;u<o;u++)for(l[u]=[],e=0;e<m.length;e++)l[u][e]=r.dot([v[u]],[m[e]]);return[n,f,v,l]}}),function(n){for(var e=0;e<n.length;e++)(function(n){r.fn[n]=function(e,t){var o=this;return t?(setTimeout(function(){t.call(o,r.fn[n].call(o,e))},15),this):"number"==typeof r[n](this,e)?r[n](this,e):r(r[n](this,e))}})(n[e])}("add divide multiply subtract dot pow abs norm angle".split(" "))}(this.jStat,Math),function(r,n){var e=[].slice,t=r.utils.isNumber;r.extend({zscore:function(){var n=e.call(arguments);return t(n[1])?(n[0]-n[1])/n[2]:(n[0]-r.mean(n[1]))/r.stdev(n[1],n[2])},ztest:function(){var o=e.call(arguments);if(4===o.length){if(t(o[1])){var a=r.zscore(o[0],o[1],o[2]);return 1===o[3]?r.normal.cdf(-n.abs(a),0,1):2*r.normal.cdf(-n.abs(a),0,1)}var a=o[0];return 1===o[2]?r.normal.cdf(-n.abs(a),0,1):2*r.normal.cdf(-n.abs(a),0,1)}var a=r.zscore(o[0],o[1],o[3]);return 1===o[1]?r.normal.cdf(-n.abs(a),0,1):2*r.normal.cdf(-n.abs(a),0,1)}}),r.extend(r.fn,{zscore:function(r,n){return(r-this.mean())/this.stdev(n)},ztest:function(e,t,o){var a=n.abs(this.zscore(e,o));return 1===t?r.normal.cdf(-a,0,1):2*r.normal.cdf(-a,0,1)}}),r.extend({tscore:function(){var t=e.call(arguments);return 4===t.length?(t[0]-t[1])/(t[2]/n.sqrt(t[3])):(t[0]-r.mean(t[1]))/(r.stdev(t[1],!0)/n.sqrt(t[1].length))},ttest:function(){var o,a=e.call(arguments);return 5===a.length?(o=n.abs(r.tscore(a[0],a[1],a[2],a[3])),1===a[4]?r.studentt.cdf(-o,a[3]-1):2*r.studentt.cdf(-o,a[3]-1)):t(a[1])?(o=n.abs(a[0]),1==a[2]?r.studentt.cdf(-o,a[1]-1):2*r.studentt.cdf(-o,a[1]-1)):(o=n.abs(r.tscore(a[0],a[1])),1==a[2]?r.studentt.cdf(-o,a[1].length-1):2*r.studentt.cdf(-o,a[1].length-1))}}),r.extend(r.fn,{tscore:function(r){return(r-this.mean())/(this.stdev(!0)/n.sqrt(this.cols()))},ttest:function(e,t){return 1===t?1-r.studentt.cdf(n.abs(this.tscore(e)),this.cols()-1):2*r.studentt.cdf(-n.abs(this.tscore(e)),this.cols()-1)}}),r.extend({anovafscore:function(){var t,o,a,u,i,f,s,c,l=e.call(arguments);if(1===l.length){for(i=new Array(l[0].length),s=0;s<l[0].length;s++)i[s]=l[0][s];l=i}if(2===l.length)return r.variance(l[0])/r.variance(l[1]);for(o=new Array,s=0;s<l.length;s++)o=o.concat(l[s]);for(a=r.mean(o),t=0,s=0;s<l.length;s++)t+=l[s].length*n.pow(r.mean(l[s])-a,2);for(t/=l.length-1,f=0,s=0;s<l.length;s++)for(u=r.mean(l[s]),c=0;c<l[s].length;c++)f+=n.pow(l[s][c]-u,2);return f/=o.length-l.length,t/f},anovaftest:function(){var n,o,a,u,i=e.call(arguments);if(t(i[0]))return 1-r.centralF.cdf(i[0],i[1],i[2]);for(anovafscore=r.anovafscore(i),n=i.length-1,a=0,u=0;u<i.length;u++)a+=i[u].length;return o=a-n-1,1-r.centralF.cdf(anovafscore,n,o)},ftest:function(n,e,t){return 1-r.centralF.cdf(n,e,t)}}),r.extend(r.fn,{anovafscore:function(){return r.anovafscore(this.toArray())},anovaftes:function(){var n,e=0;for(n=0;n<this.length;n++)e+=this[n].length;return r.ftest(this.anovafscore(),this.length-1,e-this.length)}}),r.extend({normalci:function(){var t,o=e.call(arguments),a=new Array(2);return t=4===o.length?n.abs(r.normal.inv(o[1]/2,0,1)*o[2]/n.sqrt(o[3])):n.abs(r.normal.inv(o[1]/2,0,1)*r.stdev(o[2])/n.sqrt(o[2].length)),a[0]=o[0]-t,a[1]=o[0]+t,a},tci:function(){var t,o=e.call(arguments),a=new Array(2);return t=4===o.length?n.abs(r.studentt.inv(o[1]/2,o[3]-1)*o[2]/n.sqrt(o[3])):n.abs(r.studentt.inv(o[1]/2,o[2].length-1)*r.stdev(o[2],!0)/n.sqrt(o[2].length)),a[0]=o[0]-t,a[1]=o[0]+t,a},significant:function(r,n){return r<n}}),r.extend(r.fn,{normalci:function(n,e){return r.normalci(n,e,this.toArray())},tci:function(n,e){return r.tci(n,e,this.toArray())}})}(this.jStat,Math)},function(r,n){},function(r,n,e){function t(r){return/^[01]{1,10}$/.test(r)}var o=e(5),a=e(13).jStat,u=e(11),i=e(4),f=e(16),s=e(6);n.BESSELI=function(r,n){return r=i.parseNumber(r),r instanceof Error?r:(n=i.parseNumber(n),n instanceof Error?n:n<0?o.num:f.besseli(r,n))},n.BESSELJ=function(r,n){return r=i.parseNumber(r),r instanceof Error?r:(n=i.parseNumber(n),n instanceof Error?n:n<0?o.num:f.besselj(r,n))},n.BESSELK=function(r,n){return r=i.parseNumber(r),r instanceof Error?r:(n=i.parseNumber(n),n instanceof Error?n:n<0?o.num:f.besselk(r,n))},n.BESSELY=function(r,n){return r=i.parseNumber(r),r instanceof Error?r:(n=i.parseNumber(n),n instanceof Error?n:n<0?o.num:f.bessely(r,n))},n.BIN2DEC=function(r){if(!t(r))return o.num;var n=parseInt(r,2),e=r.toString();return 10===e.length&&"1"===e.substring(0,1)?parseInt(e.substring(1),2)-512:n},n.BIN2HEX=function(r,n){if(!t(r))return o.num;var e=r.toString();if(10===e.length&&"1"===e.substring(0,1))return(0xfffffffe00+parseInt(e.substring(1),2)).toString(16);var a=parseInt(r,2).toString(16);return void 0===n?a:isNaN(n)?o.value:n<0?o.num:(n=Math.floor(n),n>=a.length?u.REPT("0",n-a.length)+a:o.num)},n.BIN2OCT=function(r,n){if(!t(r))return o.num;var e=r.toString();if(10===e.length&&"1"===e.substring(0,1))return(1073741312+parseInt(e.substring(1),2)).toString(8);var a=parseInt(r,2).toString(8);return void 0===n?a:isNaN(n)?o.value:n<0?o.num:(n=Math.floor(n),n>=a.length?u.REPT("0",n-a.length)+a:o.num)},n.BITAND=function(r,n){return r=i.parseNumber(r),r instanceof Error?r:(n=i.parseNumber(n),n instanceof Error?n:r<0||n<0?o.num:Math.floor(r)!==r||Math.floor(n)!==n?o.num:r>0xffffffffffff||n>0xffffffffffff?o.num:r&n)},n.BITLSHIFT=function(r,n){return r=i.parseNumber(r),r instanceof Error?r:(n=i.parseNumber(n),n instanceof Error?n:r<0?o.num:Math.floor(r)!==r?o.num:r>0xffffffffffff?o.num:Math.abs(n)>53?o.num:n>=0?r<<n:r>>-n)},n.BITOR=function(r,n){return r=i.parseNumber(r),r instanceof Error?r:(n=i.parseNumber(n),n instanceof Error?n:r<0||n<0?o.num:Math.floor(r)!==r||Math.floor(n)!==n?o.num:r>0xffffffffffff||n>0xffffffffffff?o.num:r|n)},n.BITRSHIFT=function(r,n){return r=i.parseNumber(r),r instanceof Error?r:(n=i.parseNumber(n),n instanceof Error?n:r<0?o.num:Math.floor(r)!==r?o.num:r>0xffffffffffff?o.num:Math.abs(n)>53?o.num:n>=0?r>>n:r<<-n)},n.BITXOR=function(r,n){return r=i.parseNumber(r),r instanceof Error?r:(n=i.parseNumber(n),n instanceof Error?n:r<0||n<0?o.num:Math.floor(r)!==r||Math.floor(n)!==n?o.num:r>0xffffffffffff||n>0xffffffffffff?o.num:r^n)},n.COMPLEX=function(r,n,e){if(r=i.parseNumber(r),r instanceof Error)return r;if(n=i.parseNumber(n),n instanceof Error)return n;if(e=void 0===e?"i":e,"i"!==e&&"j"!==e)return o.value;if(0===r&&0===n)return 0;if(0===r)return 1===n?e:n.toString()+e;if(0===n)return r.toString();var t=n>0?"+":"";return r.toString()+t+(1===n?e:n.toString()+e)},n.CONVERT=function(r,n,e){if(r=i.parseNumber(r),r instanceof Error)return r;for(var t,a=[["a.u. of action","auh",null,"action",!1,!1,1.05457168181818e-34],["a.u. of charge","e",null,"electric_charge",!1,!1,1.60217653141414e-19],["a.u. of energy","Eh",null,"energy",!1,!1,4.35974417757576e-18],["a.u. of length","a0",null,"length",!1,!1,5.29177210818182e-11],["a.u. of mass","me",null,"mass",!1,!1,9.10938261616162e-31],["a.u. of time","auh/Eh",null,"time",!1,!1,2.41888432650516e-17],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ngstrm","",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,1.49597870691667e-11],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m2",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ngstrm","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,8.46786664623715e-47],["cubic metre","m3",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,1.66053886282828e-27],["day","d",["day"],"time",!1,!0,86400],["degree","",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m/s2",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m2/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","arcmin",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","nuh",null,"action",!1,!1,1.05457168181818e-34],["n.u. of mass","nume",null,"mass",!1,!1,9.10938261616162e-31],["n.u. of speed","nuc0",null,"speed",!1,!1,299792458],["n.u. of time","nuh/(mec02)",null,"time",!1,!1,1.28808866778687e-21],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa_s",null,"dynamic_viscosity",!0,!1,1],["pferdestrke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","arcsec",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ngstrm","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,8.95054210748189e31],["square meter","m2",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],u={Yi:["yobi",80,1.2089258196146292e24,"Yi","yotta"],Zi:["zebi",70,0x400000000000000000,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},f={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},s=null,c=null,l=n,m=e,p=1,h=1,E=0;E<a.length;E++)t=null===a[E][2]?[]:a[E][2],(a[E][1]===l||t.indexOf(l)>=0)&&(s=a[E]),(a[E][1]===m||t.indexOf(m)>=0)&&(c=a[E]);if(null===s){var v=u[n.substring(0,2)],g=f[n.substring(0,1)];"da"===n.substring(0,2)&&(g=["dekao",10,"da"]),v?(p=v[2],l=n.substring(2)):g&&(p=g[1],l=n.substring(g[2].length));for(var N=0;N<a.length;N++)t=null===a[N][2]?[]:a[N][2],(a[N][1]===l||t.indexOf(l)>=0)&&(s=a[N])}if(null===c){var b=u[e.substring(0,2)],d=f[e.substring(0,1)];"da"===e.substring(0,2)&&(d=["dekao",10,"da"]),b?(h=b[2],m=e.substring(2)):d&&(h=d[1],m=e.substring(d[2].length));for(var M=0;M<a.length;M++)t=null===a[M][2]?[]:a[M][2],(a[M][1]===m||t.indexOf(m)>=0)&&(c=a[M])}return null===s||null===c?o.na:s[3]!==c[3]?o.na:r*s[6]*p/(c[6]*h)},n.DEC2BIN=function(r,n){if(r=i.parseNumber(r),r instanceof Error)return r;if(!/^-?[0-9]{1,3}$/.test(r)||r<-512||r>511)return o.num;if(r<0)return"1"+u.REPT("0",9-(512+r).toString(2).length)+(512+r).toString(2);var e=parseInt(r,10).toString(2);return"undefined"==typeof n?e:isNaN(n)?o.value:n<0?o.num:(n=Math.floor(n),n>=e.length?u.REPT("0",n-e.length)+e:o.num)},n.DEC2HEX=function(r,n){if(r=i.parseNumber(r),r instanceof Error)return r;if(!/^-?[0-9]{1,12}$/.test(r)||r<-549755813888||r>549755813887)return o.num;if(r<0)return(1099511627776+r).toString(16);var e=parseInt(r,10).toString(16);return"undefined"==typeof n?e:isNaN(n)?o.value:n<0?o.num:(n=Math.floor(n),n>=e.length?u.REPT("0",n-e.length)+e:o.num)},n.DEC2OCT=function(r,n){if(r=i.parseNumber(r),r instanceof Error)return r;if(!/^-?[0-9]{1,9}$/.test(r)||r<-536870912||r>536870911)return o.num;if(r<0)return(1073741824+r).toString(8);var e=parseInt(r,10).toString(8);return"undefined"==typeof n?e:isNaN(n)?o.value:n<0?o.num:(n=Math.floor(n),n>=e.length?u.REPT("0",n-e.length)+e:o.num)},n.DELTA=function(r,n){return n=void 0===n?0:n,r=i.parseNumber(r),r instanceof Error?r:(n=i.parseNumber(n),n instanceof Error?n:r===n?1:0)},n.ERF=function(r,n){return n=void 0===n?0:n,r=i.parseNumber(r),r instanceof Error?r:(n=i.parseNumber(n),n instanceof Error?n:a.erf(r))},n.ERF.PRECISE=function(){throw new Error("ERF.PRECISE is not implemented")},n.ERFC=function(r){return r=i.parseNumber(r),r instanceof Error?r:a.erfc(r)},n.ERFC.PRECISE=function(){throw new Error("ERFC.PRECISE is not implemented")},n.GESTEP=function(r,n){return n=n||0,r=i.parseNumber(r),r instanceof Error?r:r>=n?1:0},n.HEX2BIN=function(r,n){if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return o.num;var e=10===r.length&&"f"===r.substring(0,1).toLowerCase(),t=e?parseInt(r,16)-1099511627776:parseInt(r,16);if(t<-512||t>511)return o.num;if(e)return"1"+u.REPT("0",9-(512+t).toString(2).length)+(512+t).toString(2);var a=t.toString(2);return void 0===n?a:isNaN(n)?o.value:n<0?o.num:(n=Math.floor(n),n>=a.length?u.REPT("0",n-a.length)+a:o.num)},n.HEX2DEC=function(r){if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return o.num;var n=parseInt(r,16);return n>=549755813888?n-1099511627776:n},n.HEX2OCT=function(r,n){if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return o.num;var e=parseInt(r,16);if(e>536870911&&e<0xffe0000000)return o.num;if(e>=0xffe0000000)return(e-0xffc0000000).toString(8);var t=e.toString(8);return void 0===n?t:isNaN(n)?o.value:n<0?o.num:(n=Math.floor(n),n>=t.length?u.REPT("0",n-t.length)+t:o.num)},n.IMABS=function(r){var e=n.IMREAL(r);if(e instanceof Error)return e;var t=n.IMAGINARY(r);return t instanceof Error?t:Math.sqrt(Math.pow(e,2)+Math.pow(t,2))},n.IMAGINARY=function(r){if(void 0===r||r===!0||r===!1)return o.value;if(0===r||"0"===r)return 0;if(["i","j"].indexOf(r)>=0)return 1;r=r.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var n=r.indexOf("+"),e=r.indexOf("-");0===n&&(n=r.indexOf("+",1)),0===e&&(e=r.indexOf("-",1));var t=r.substring(r.length-1,r.length),a="i"===t||"j"===t;return n>=0||e>=0?a?n>=0?isNaN(r.substring(0,n))||isNaN(r.substring(n+1,r.length-1))?o.num:Number(r.substring(n+1,r.length-1)):isNaN(r.substring(0,e))||isNaN(r.substring(e+1,r.length-1))?o.num:-Number(r.substring(e+1,r.length-1)):o.num:a?isNaN(r.substring(0,r.length-1))?o.num:r.substring(0,r.length-1):isNaN(r)?o.num:0},n.IMARGUMENT=function(r){var e=n.IMREAL(r);if(e instanceof Error)return e;var t=n.IMAGINARY(r);return t instanceof Error?t:0===e&&0===t?o.div0:0===e&&t>0?Math.PI/2:0===e&&t<0?-Math.PI/2:0===t&&e>0?0:0===t&&e<0?-Math.PI:e>0?Math.atan(t/e):e<0&&t>=0?Math.atan(t/e)+Math.PI:Math.atan(t/e)-Math.PI},n.IMCONJUGATE=function(r){var e=n.IMREAL(r);if(e instanceof Error)return e;var t=n.IMAGINARY(r);if(t instanceof Error)return t;var o=r.substring(r.length-1);return o="i"===o||"j"===o?o:"i",0!==t?n.COMPLEX(e,-t,o):r},n.IMCOS=function(r){var e=n.IMREAL(r);if(e instanceof Error)return e;var t=n.IMAGINARY(r);if(t instanceof Error)return t;var o=r.substring(r.length-1);return o="i"===o||"j"===o?o:"i",n.COMPLEX(Math.cos(e)*(Math.exp(t)+Math.exp(-t))/2,-Math.sin(e)*(Math.exp(t)-Math.exp(-t))/2,o)},n.IMCOSH=function(r){var e=n.IMREAL(r);if(e instanceof Error)return e;var t=n.IMAGINARY(r);if(t instanceof Error)return t;var o=r.substring(r.length-1);return o="i"===o||"j"===o?o:"i",n.COMPLEX(Math.cos(t)*(Math.exp(e)+Math.exp(-e))/2,Math.sin(t)*(Math.exp(e)-Math.exp(-e))/2,o)},n.IMCOT=function(r){var e=n.IMREAL(r);if(e instanceof Error)return e;var t=n.IMAGINARY(r);return t instanceof Error?t:n.IMDIV(n.IMCOS(r),n.IMSIN(r))},n.IMDIV=function(r,e){var t=n.IMREAL(r);if(t instanceof Error)return t;var a=n.IMAGINARY(r);if(a instanceof Error)return a;var u=n.IMREAL(e);if(u instanceof Error)return u;var i=n.IMAGINARY(e);if(i instanceof Error)return i;var f=r.substring(r.length-1),s=e.substring(e.length-1),c="i";if("j"===f?c="j":"j"===s&&(c="j"),0===u&&0===i)return o.num;var l=u*u+i*i;return n.COMPLEX((t*u+a*i)/l,(a*u-t*i)/l,c)},n.IMEXP=function(r){var e=n.IMREAL(r);if(e instanceof Error)return e;var t=n.IMAGINARY(r);if(t instanceof Error)return t;var o=r.substring(r.length-1);o="i"===o||"j"===o?o:"i";var a=Math.exp(e);return n.COMPLEX(a*Math.cos(t),a*Math.sin(t),o)},n.IMLN=function(r){var e=n.IMREAL(r);if(e instanceof Error)return e;var t=n.IMAGINARY(r);if(t instanceof Error)return t;var o=r.substring(r.length-1);return o="i"===o||"j"===o?o:"i",n.COMPLEX(Math.log(Math.sqrt(e*e+t*t)),Math.atan(t/e),o)},n.IMLOG10=function(r){var e=n.IMREAL(r);if(e instanceof Error)return e;var t=n.IMAGINARY(r);if(t instanceof Error)return t;var o=r.substring(r.length-1);return o="i"===o||"j"===o?o:"i",n.COMPLEX(Math.log(Math.sqrt(e*e+t*t))/Math.log(10),Math.atan(t/e)/Math.log(10),o)},n.IMLOG2=function(r){var e=n.IMREAL(r);if(e instanceof Error)return e;var t=n.IMAGINARY(r);if(t instanceof Error)return t;var o=r.substring(r.length-1);return o="i"===o||"j"===o?o:"i",n.COMPLEX(Math.log(Math.sqrt(e*e+t*t))/Math.log(2),Math.atan(t/e)/Math.log(2),o)},n.IMPOWER=function(r,e){if(e=i.parseNumber(e),e instanceof Error)return e;var t=n.IMREAL(r);if(t instanceof Error)return t;var o=n.IMAGINARY(r);if(o instanceof Error)return o;var a=r.substring(r.length-1);a="i"===a||"j"===a?a:"i";var u=Math.pow(n.IMABS(r),e),f=n.IMARGUMENT(r);return n.COMPLEX(u*Math.cos(e*f),u*Math.sin(e*f),a)},n.IMPRODUCT=function(){for(var r=arguments[0],e=1;e<arguments.length;e++){var t=n.IMREAL(r);if(t instanceof Error)return t;var o=n.IMAGINARY(r);if(o instanceof Error)return o;var a=n.IMREAL(arguments[e]);if(a instanceof Error)return a;var u=n.IMAGINARY(arguments[e]);if(u instanceof Error)return u;r=n.COMPLEX(t*a-o*u,t*u+o*a)}return r},n.IMREAL=function(r){if(void 0===r||r===!0||r===!1)return o.value;if(0===r||"0"===r)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(r)>=0)return 0;var n=r.indexOf("+"),e=r.indexOf("-");0===n&&(n=r.indexOf("+",1)),0===e&&(e=r.indexOf("-",1));var t=r.substring(r.length-1,r.length),a="i"===t||"j"===t;return n>=0||e>=0?a?n>=0?isNaN(r.substring(0,n))||isNaN(r.substring(n+1,r.length-1))?o.num:Number(r.substring(0,n)):isNaN(r.substring(0,e))||isNaN(r.substring(e+1,r.length-1))?o.num:Number(r.substring(0,e)):o.num:a?isNaN(r.substring(0,r.length-1))?o.num:0:isNaN(r)?o.num:r},n.IMSEC=function(r){if(r===!0||r===!1)return o.value;var e=n.IMREAL(r);if(e instanceof Error)return e;var t=n.IMAGINARY(r);return t instanceof Error?t:n.IMDIV("1",n.IMCOS(r))},n.IMSECH=function(r){var e=n.IMREAL(r);if(e instanceof Error)return e;var t=n.IMAGINARY(r);return t instanceof Error?t:n.IMDIV("1",n.IMCOSH(r))},n.IMSIN=function(r){var e=n.IMREAL(r);if(e instanceof Error)return e;var t=n.IMAGINARY(r);if(t instanceof Error)return t;var o=r.substring(r.length-1);return o="i"===o||"j"===o?o:"i",n.COMPLEX(Math.sin(e)*(Math.exp(t)+Math.exp(-t))/2,Math.cos(e)*(Math.exp(t)-Math.exp(-t))/2,o)},n.IMSINH=function(r){var e=n.IMREAL(r);if(e instanceof Error)return e;var t=n.IMAGINARY(r);if(t instanceof Error)return t;var o=r.substring(r.length-1);return o="i"===o||"j"===o?o:"i",n.COMPLEX(Math.cos(t)*(Math.exp(e)-Math.exp(-e))/2,Math.sin(t)*(Math.exp(e)+Math.exp(-e))/2,o)},n.IMSQRT=function(r){var e=n.IMREAL(r);if(e instanceof Error)return e;var t=n.IMAGINARY(r);if(t instanceof Error)return t;var o=r.substring(r.length-1);o="i"===o||"j"===o?o:"i";var a=Math.sqrt(n.IMABS(r)),u=n.IMARGUMENT(r);return n.COMPLEX(a*Math.cos(u/2),a*Math.sin(u/2),o)},n.IMSUB=function(r,e){var t=n.IMREAL(r);if(t instanceof Error)return t;var o=n.IMAGINARY(r);if(o instanceof Error)return o;var a=n.IMREAL(e);if(a instanceof Error)return a;var u=n.IMAGINARY(e);if(u instanceof Error)return u;var i=r.substring(r.length-1),f=e.substring(e.length-1),s="i";return"j"===i?s="j":"j"===f&&(s="j"),n.COMPLEX(t-a,o-u,s)},n.IMSUM=function(){for(var r=s.flatten(arguments),e=r[0],t=1;t<r.length;t++){var o=n.IMREAL(e);if(o instanceof Error)return o;var a=n.IMAGINARY(e);if(a instanceof Error)return a;var u=n.IMREAL(r[t]);if(u instanceof Error)return u;var i=n.IMAGINARY(r[t]);if(i instanceof Error)return i;e=n.COMPLEX(o+u,a+i)}return e},n.IMTAN=function(r){if(r===!0||r===!1)return o.value;var e=n.IMREAL(r);if(e instanceof Error)return e;var t=n.IMAGINARY(r);return t instanceof Error?t:n.IMDIV(n.IMSIN(r),n.IMCOS(r))},n.OCT2BIN=function(r,n){if(!/^[0-7]{1,10}$/.test(r))return o.num;var e=10===r.length&&"7"===r.substring(0,1),t=e?parseInt(r,8)-1073741824:parseInt(r,8);if(t<-512||t>511)return o.num;if(e)return"1"+u.REPT("0",9-(512+t).toString(2).length)+(512+t).toString(2);var a=t.toString(2);return"undefined"==typeof n?a:isNaN(n)?o.value:n<0?o.num:(n=Math.floor(n),n>=a.length?u.REPT("0",n-a.length)+a:o.num)},n.OCT2DEC=function(r){if(!/^[0-7]{1,10}$/.test(r))return o.num;var n=parseInt(r,8);return n>=536870912?n-1073741824:n},n.OCT2HEX=function(r,n){if(!/^[0-7]{1,10}$/.test(r))return o.num;var e=parseInt(r,8);if(e>=536870912)return"ff"+(e+3221225472).toString(16);var t=e.toString(16);return void 0===n?t:isNaN(n)?o.value:n<0?o.num:(n=Math.floor(n),n>=t.length?u.REPT("0",n-t.length)+t:o.num)}},function(r,n,e){function t(r,n){return r.reduce(function(r,e){return n*r+e},0)}function o(r,n,e,t,o){o||(o=-1);var a,u=2/r;if(0===n)return e;if(1===n)return t;for(var i=1;i!=n;++i)a=t*i*u+o*e,e=t,t=a;return t}function a(r,n,e,t,a){return function(u,i){if(0===i)return r(u);if(1===i)return n(u);if(i<0)throw e+": Order ("+i+") must be nonnegative";if(1==t&&0===u)throw e+": Undefined when x == 0";if(2==t&&u<=0)throw e+": Undefined when x <= 0";var f=r(u),s=n(u);return o(u,i,f,s,a)}}var u=Math,i=function(){function r(r){var n,o,c,l=r*r,m=u.abs(r)-.785398164;return u.abs(r)<8?(o=t(e,l),c=t(a,l),n=o/c):(l=64/l,o=t(i,l),c=t(f,l),n=u.sqrt(s/u.abs(r))*(u.cos(m)*o-u.sin(m)*c*8/u.abs(r))),n}function n(r){var n,e,o,a=r*r,i=u.abs(r)-2.356194491;return Math.abs(r)<8?(e=r*t(c,a),o=t(l,a),n=e/o):(a=64/a,e=t(m,a),o=t(p,a),n=u.sqrt(s/u.abs(r))*(u.cos(i)*e-u.sin(i)*o*8/u.abs(r)),r<0&&(n=-n)),n}var e=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),a=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),i=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),f=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse(),s=.636619772,c=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),l=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),m=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),p=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();
return function(e,t){if(t=Math.round(t),0===t)return r(u.abs(e));if(1===t)return n(u.abs(e));if(t<0)throw"BESSELJ: Order ("+t+") must be nonnegative";if(0===u.abs(e))return 0;var a,i,f,s,c,l,m,p,h=2/u.abs(e);if(u.abs(e)>t)a=o(e,t,r(u.abs(e)),n(u.abs(e)),-1);else{for(f=2*u.floor((t+u.floor(u.sqrt(40*t)))/2),s=0,l=a=c=0,m=1,i=f;i>0;i--)p=i*h*m-l,l=m,m=p,u.abs(m)>1e10&&(m*=1e-10,l*=1e-10,a*=1e-10,c*=1e-10),s&&(c+=m),s=!s,i==t&&(a=l);c=2*c-m,a/=c}return e<0&&t%2?-a:a}}(),f=function(){function r(r){var n,a,l,m=r*r,p=r-.785398164;return r<8?(a=t(e,m),l=t(o,m),n=a/l+c*i(r,0)*u.log(r)):(m=64/m,a=t(f,m),l=t(s,m),n=u.sqrt(c/r)*(u.sin(p)*a+u.cos(p)*l*8/r)),n}function n(r){var n,e,o,a=r*r,f=r-2.356194491;return r<8?(e=r*t(l,a),o=t(m,a),n=e/o+c*(i(r,1)*u.log(r)-1/r)):(a=64/a,e=t(p,a),o=t(h,a),n=u.sqrt(c/r)*(u.sin(f)*e+u.cos(f)*o*8/r)),n}var e=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),o=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),f=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),s=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),c=.636619772,l=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),m=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),p=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),h=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();return a(r,n,"BESSELY",1,-1)}(),s=function(){function r(r){return r<=3.75?t(e,r*r/14.0625):u.exp(u.abs(r))/u.sqrt(u.abs(r))*t(o,3.75/u.abs(r))}function n(r){return r<3.75?r*t(a,r*r/14.0625):(r<0?-1:1)*u.exp(u.abs(r))/u.sqrt(u.abs(r))*t(i,3.75/u.abs(r))}var e=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),o=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),a=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),i=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();return function e(t,o){if(o=Math.round(o),0===o)return r(t);if(1==o)return n(t);if(o<0)throw"BESSELI Order ("+o+") must be nonnegative";if(0===u.abs(t))return 0;var a,i,f,s,c,l,m=2/u.abs(t);for(f=2*u.round((o+u.round(u.sqrt(40*o)))/2),s=a=0,c=1,i=f;i>0;i--)l=i*m*c+s,s=c,c=l,u.abs(c)>1e10&&(c*=1e-10,s*=1e-10,a*=1e-10),i==o&&(a=s);return a*=e(t,0)/c,t<0&&o%2?-a:a}}(),c=function(){function r(r){return r<=2?-u.log(r/2)*s(r,0)+t(e,r*r/4):u.exp(-r)/u.sqrt(r)*t(o,2/r)}function n(r){return r<=2?u.log(r/2)*s(r,1)+1/r*t(i,r*r/4):u.exp(-r)/u.sqrt(r)*t(f,2/r)}var e=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),o=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),i=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),f=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return a(r,n,"BESSELK",2,1)}();n.besselj=i,n.bessely=f,n.besseli=s,n.besselk=c},function(r,n,e){var t=e(5),o=e(4),a=e(7),u=e(6);n.AND=function(){for(var r=u.flatten(arguments),n=!0,e=0;e<r.length;e++){var t=o.parseBool(r[e]);if(t instanceof Error)return t;t||(n=!1)}return n},n.FALSE=function(){return!1},n.IF=function(r,n,e){return void 0===n&&(n=!0),void 0===e&&(e=!1),r=o.parseBool(r),r instanceof Error?r:r?n:e},n.IFERROR=function(r,n){return a.ISERROR(r)?n:r},n.IFNA=function(r,n){return r===t.na?n:r},n.NOT=function(r){return r=o.parseBool(r),r instanceof Error?r:!r},n.OR=function(){for(var r=u.flatten(arguments),n=!1,e=0;e<r.length;e++){var t=o.parseBool(r[e]);if(t instanceof Error)return t;t&&(n=!0)}return n},n.TRUE=function(){return!0},n.XOR=function(){for(var r=u.flatten(arguments),n=0,e=0;e<r.length;e++){var t=o.parseBool(r[e]);if(t instanceof Error)return t;t&&n++}return!!(1&Math.floor(Math.abs(n)))}},14,function(r,n,e){var t=e(5),o=e(4),a=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],u=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],i=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];n.DATE=function(r,n,e){if(r=o.parseNumber(r),r instanceof Error)return r;if(n=o.parseNumber(n),n instanceof Error)return n;if(e=o.parseNumber(e),e instanceof Error)return e;if(r<0||n<0||e<0)return t.num;var a=Date.UTC(r,n-1,e);return o.jsToExcelTimestamp(a)},n.DATEVALUE=function(r){if("string"!=typeof r)return t.value;var n=o.parseDate(r);return n instanceof Error?n:o.jsToExcelTimestamp(n)},n.DAY=function(r){var n=o.parseDate(r);return n instanceof Error?n:n.getUTCDate()},n.DAYS=function(r,n){return r=o.parseDate(r),r instanceof Error?r:(n=o.parseDate(n),n instanceof Error?n:o.jsToExcelTimestamp(r)-o.jsToExcelTimestamp(n))},n.DAYS360=function(r,n,e){if(r=o.parseDate(r),r instanceof Error)return r;if(n=o.parseDate(n),n instanceof Error)return n;if(e=o.parseBool(e),e instanceof Error)return e;var t,a,u=r.getUTCMonth(),i=n.getUTCMonth();if(e)t=31===r.getUTCDate()?30:r.getUTCDate(),a=31===n.getUTCDate()?30:n.getUTCDate();else{var f=o.createUTCDate(r.getUTCFullYear(),u+1,0).getUTCDate(),s=o.createUTCDate(n.getUTCFullYear(),i+1,0).getUTCDate();t=r.getUTCDate()===f?30:r.getUTCDate(),n.getUTCDate()==s?t<30?(i++,a=1):a=30:a=n.getUTCDate()}return 360*(n.getUTCFullYear()-r.getUTCFullYear())+30*(i-u)+(a-t)},n.EDATE=function(r,n){return r=o.parseDate(r),r instanceof Error?r:isNaN(n)?t.value:(n=parseInt(n,10),r.setUTCMonth(r.getUTCMonth()+n),o.jsToExcelTimestamp(r))},n.EOMONTH=function(r,n){return r=o.parseDate(r),r instanceof Error?r:isNaN(n)?t.value:(n=parseInt(n,10),o.jsToExcelTimestamp(o.createUTCDate(r.getUTCFullYear(),r.getUTCMonth()+n+1,0)))},n.HOUR=function(r){return r=o.parseDate(r),r instanceof Error?r:r.getUTCHours()},n.ISOWEEKNUM=function(r){if(r=o.parseDate(r),r instanceof Error)return r;r.setUTCHours(0,0,0),r.setUTCDate(r.getUTCDate()+4-(r.getUTCDay()||7));var n=o.createUTCDate(r.getUTCFullYear(),0,1);return Math.ceil(((r-n)/864e5+1)/7)},n.MINUTE=function(r){return r=o.parseDate(r),r instanceof Error?r:r.getUTCMinutes()},n.MONTH=function(r){return r=o.parseDate(r),r instanceof Error?r:r.getUTCMonth()+1},n.NETWORKDAYS=function(r,e,t){return n.NETWORKDAYS.INTL(r,e,1,t)},n.NETWORKDAYS.INTL=function(r,n,e,a){if(r=o.parseDate(r),r instanceof Error)return r;if(n=o.parseDate(n),n instanceof Error)return n;if(e=void 0===e?i[1]:i[e],!(e instanceof Array))return t.value;void 0===a?a=[]:a instanceof Array||(a=[a]);for(var u=0;u<a.length;u++){var f=o.parseDate(a[u]);if(f instanceof Error)return f;a[u]=f}var s=(n-r)/864e5,c=s,l=r;for(u=0;u<s;u++){var m=l.getUTCDay(),p=!1;m!==e[0]&&m!==e[1]||(p=!0);for(var h=0;h<a.length;h++){var E=a[h];if(E.getUTCDate()==l.getUTCDate()&&E.getUTCMonth()==l.getUTCMonth()&&E.getUTCFullYear()==l.getUTCFullYear()){p=!0;break}}p&&c--,l.setUTCDate(l.getUTCDate()+1)}return c+1},n.NOW=function(){return o.jsToExcelTimestamp(o.createUTCDate())},n.SECOND=function(r){return r=o.parseDate(r),r instanceof Error?r:r.getUTCSeconds()},n.TIME=function(r,n,e){return r=o.parseNumber(r),r instanceof Error?r:(n=o.parseNumber(n),n instanceof Error?n:(e=o.parseNumber(e),e instanceof Error?e:r<0||n<0||e<0?t.num:(3600*r+60*n+e)/86400))},n.TIMEVALUE=function(r){return r=o.parseDate(r),r instanceof Error?r:(3600*r.getUTCHours()+60*r.getUTCMinutes()+r.getUTCSeconds())/86400},n.TODAY=function(){var r=o.createUTCDate();return r.setUTCHours(0,0,0,0),o.jsToExcelTimestamp(r)},n.WEEKDAY=function(r,n){if(r=o.parseDate(r),r instanceof Error)return r;void 0===n&&(n=1);var e=r.getUTCDay();return u[n][e]},n.WEEKNUM=function(r,e){if(r=o.parseDate(r),r instanceof Error)return r;if(void 0===e&&(e=1),21===e)return n.ISOWEEKNUM(r);var t=a[e],u=o.createUTCDate(r.getUTCFullYear(),0,1),i=u.getUTCDay()<t?1:0;return u-=24*Math.abs(u.getUTCDay()-t)*60*60*1e3,Math.floor((r-u)/864e5/7+1)+i},n.WORKDAY=function(r,e,t){return n.WORKDAY.INTL(r,e,1,t)},n.WORKDAY.INTL=function(r,n,e,a){if(r=o.parseDate(r),r instanceof Error)return r;if(n=o.parseNumber(n),n instanceof Error)return n;if(e=void 0===e?i[1]:i[e],!(e instanceof Array))return t.value;void 0===a?a=[]:a instanceof Array||(a=[a]),r.setUTCHours(0,0,0);for(var u=0;u<a.length;u++){var f=o.parseDate(a[u]);if(f instanceof Error)return f;a[u]=f}for(var s=0,c=Math.abs(n);s<c;){n>=0?r.setUTCDate(r.getUTCDate()+1):r.setUTCDate(r.getUTCDate()-1);var l=r.getUTCDay();if(l!==e[0]&&l!==e[1]){for(var m=0;m<a.length;m++){var p=a[m];if(p.getUTCDate()==r.getUTCDate()&&p.getUTCMonth()==r.getUTCMonth()&&p.getUTCFullYear()==r.getUTCFullYear()){s--;break}}s++}}return Math.round(o.jsToExcelTimestamp(r))},n.YEAR=function(r){return r=o.parseDate(r),r instanceof Error?r:r.getUTCFullYear()},n.YEARFRAC=function(r,n,e){if(r=o.parseDate(r),r instanceof Error)return r;if(n=o.parseDate(n),n instanceof Error)return n;void 0===e&&(e=0);var t=r.getUTCDate(),a=r.getUTCMonth()+1,u=r.getUTCFullYear(),i=n.getUTCDate(),f=n.getUTCMonth()+1,s=n.getUTCFullYear();switch(e){case 0:return 31===t&&31===i?(t=30,i=30):31===t?t=30:30===t&&31===i&&(i=30),(i+30*f+360*s-(t+30*a+360*u))/360;case 1:var c=function(r,n){var e=o.createUTCDate(r.getUTCFullYear(),2,1);if(1==o.createUTCDate(r.getUTCFullYear(),1,29).getUTCMonth()&&r-e<0&&n-e>=0)return!0;var t=o.createUTCDate(n.getUTCFullYear(),2,1);return 1==o.createUTCDate(n.getUTCFullYear(),1,29).getUTCMonth()&&n-t>=0&&r-t<0},l=365;if(u===s||u+1===s&&(a>f||a===f&&t>=i))return u===s&&1==o.createUTCDate(u,1,29).getUTCMonth()?l=366:(c(r,n)||1===f&&29===i)&&(l=366),(n-r)/1e3/60/60/24/l;var m=s-u+1,p=(o.createUTCDate(s+1,0,1)-o.createUTCDate(u,0,1))/1e3/60/60/24,h=p/m;return(n-r)/1e3/60/60/24/h;case 2:return(n-r)/1e3/60/60/24/360;case 3:return(n-r)/1e3/60/60/24/365;case 4:return(i+30*f+360*s-(t+30*a+360*u))/360}}},function(r,n,e){var t=e(5),o=e(19),a=e(4),u=e(6);n.ACCRINT=function(){throw new Error("ACCRINT is not implemented")},n.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},n.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},n.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},n.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},n.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},n.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},n.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},n.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},n.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},n.CUMIPMT=function(r,e,o,u,i,f){if(r=a.parseNumber(r),r instanceof Error)return r;if(e=a.parseNumber(e),e instanceof Error)return e;if(o=a.parseNumber(o),o instanceof Error)return o;if(r<=0||e<=0||o<=0)return t.num;if(u<1||i<1||u>i)return t.num;if(0!==f&&1!==f)return t.num;var s=n.PMT(r,e,o,0,f),c=0;1===u&&0===f&&(c=-o,u++);for(var l=u;l<=i;l++)c+=1===f?n.FV(r,l-2,s,o,1)-s:n.FV(r,l-1,s,o,0);return c*=r},n.CUMPRINC=function(r,e,o,u,i,f){if(r=a.parseNumber(r),r instanceof Error)return r;if(e=a.parseNumber(e),e instanceof Error)return e;if(o=a.parseNumber(o),o instanceof Error)return o;if(r<=0||e<=0||o<=0)return t.num;if(u<1||i<1||u>i)return t.num;if(0!==f&&1!==f)return t.num;var s=n.PMT(r,e,o,0,f),c=0;1===u&&(c=0===f?s+o*r:s,u++);for(var l=u;l<=i;l++)c+=f>0?s-(n.FV(r,l-2,s,o,1)-s)*r:s-n.FV(r,l-1,s,o,0)*r;return c},n.DB=function(r,n,e,o,u){if(u=void 0===u?12:u,r=a.parseNumber(r),r instanceof Error)return r;if(n=a.parseNumber(n),n instanceof Error)return n;if(e=a.parseNumber(e),e instanceof Error)return e;if(o=a.parseNumber(o),o instanceof Error)return o;if(u=a.parseNumber(u),u instanceof Error)return u;if(r<0||n<0||e<0||o<0)return t.num;if([1,2,3,4,5,6,7,8,9,10,11,12].indexOf(u)===-1)return t.num;if(o>e)return t.num;if(n>=r)return 0;for(var i=(1-Math.pow(n/r,1/e)).toFixed(3),f=r*i*u/12,s=f,c=0,l=o===e?e-1:o,m=2;m<=l;m++)c=(r-s)*i,s+=c;return 1===o?f:o===e?(r-s)*i:c},n.DDB=function(r,n,e,o,u){if(u=void 0===u?2:u,r=a.parseNumber(r),r instanceof Error)return r;if(n=a.parseNumber(n),n instanceof Error)return n;if(e=a.parseNumber(e),e instanceof Error)return e;if(o=a.parseNumber(o),o instanceof Error)return o;if(u=a.parseNumber(u),u instanceof Error)return u;if(r<0||n<0||e<0||o<0||u<=0)return t.num;if(o>e)return t.num;if(n>=r)return 0;for(var i=0,f=0,s=1;s<=o;s++)f=Math.min((r-i)*(u/e),r-n-i),i+=f;return f},n.DISC=function(){throw new Error("DISC is not implemented")},n.DOLLARDE=function(r,n){if(r=a.parseNumber(r),r instanceof Error)return r;if(n=a.parseNumber(n),n instanceof Error)return n;if(n<0)return t.num;if(n>=0&&n<1)return t.div0;n=parseInt(n,10);var e=parseInt(r,10);e+=r%1*Math.pow(10,Math.ceil(Math.log(n)/Math.LN10))/n;var o=Math.pow(10,Math.ceil(Math.log(n)/Math.LN2)+1);return e=Math.round(e*o)/o},n.DOLLARFR=function(r,n){if(r=a.parseNumber(r),r instanceof Error)return r;if(n=a.parseNumber(n),n instanceof Error)return n;if(n<0)return t.num;if(n>=0&&n<1)return t.div0;n=parseInt(n,10);var e=parseInt(r,10);return e+=r%1*Math.pow(10,-Math.ceil(Math.log(n)/Math.LN10))*n},n.DURATION=function(){throw new Error("DURATION is not implemented")},n.EFFECT=function(r,n){return r=a.parseNumber(r),r instanceof Error?r:(n=a.parseNumber(n),n instanceof Error?n:r<=0||n<1?t.num:(n=parseInt(n,10),Math.pow(1+r/n,n)-1))},n.FV=function(r,n,e,t,o){if(t=t||0,o=o||0,r=a.parseNumber(r),r instanceof Error)return r;if(n=a.parseNumber(n),n instanceof Error)return n;if(e=a.parseNumber(e),e instanceof Error)return e;if(t=a.parseNumber(t),t instanceof Error)return t;if(o=a.parseNumber(o),o instanceof Error)return o;var u;if(0===r)u=t+e*n;else{var i=Math.pow(1+r,n);u=1===o?t*i+e*(1+r)*(i-1)/r:t*i+e*(i-1)/r}return-u},n.FVSCHEDULE=function(r,n){if(r=a.parseNumber(r),r instanceof Error)return r;if(n=a.parseNumbers(u.flatten(n)),n instanceof Error)return n;for(var e=n.length,t=r,o=0;o<e;o++)t*=1+n[o];return t},n.INTRATE=function(){throw new Error("INTRATE is not implemented")},n.IPMT=function(r,e,t,o,u,i){if(u=u||0,i=i||0,r=a.parseNumber(r),r instanceof Error)return r;if(e=a.parseNumber(e),e instanceof Error)return e;if(t=a.parseNumber(t),t instanceof Error)return t;if(o=a.parseNumber(o),o instanceof Error)return o;if(u=a.parseNumber(u),u instanceof Error)return u;if(i=a.parseNumber(i),i instanceof Error)return i;var f,s=n.PMT(r,t,o,u,i);return f=1===e?1===i?0:-o:1===i?n.FV(r,e-2,s,o,1)-s:n.FV(r,e-1,s,o,0),f*r},n.IRR=function(r,n){if(n=n||0,r=a.parseNumbers(u.flatten(r)),r instanceof Error)return r;if(n=a.parseNumber(n),n instanceof Error)return n;for(var e=function(r,n,e){for(var t=e+1,o=r[0],a=1;a<r.length;a++)o+=r[a]/Math.pow(t,(n[a]-n[0])/365);return o},o=function(r,n,e){for(var t=e+1,o=0,a=1;a<r.length;a++){var u=(n[a]-n[0])/365;o-=u*r[a]/Math.pow(t,u+1)}return o},i=[],f=!1,s=!1,c=0;c<r.length;c++)i[c]=0===c?0:i[c-1]+365,r[c]>0&&(f=!0),r[c]<0&&(s=!0);if(!f||!s)return t.num;n=void 0===n?.1:n;var l,m,p,h=n,E=1e-10,v=!0;do p=e(r,i,h),l=h-p/o(r,i,h),m=Math.abs(l-h),h=l,v=m>E&&Math.abs(p)>E;while(v);return h},n.ISPMT=function(r,n,e,t){return r=a.parseNumber(r),r instanceof Error?r:(n=a.parseNumber(n),n instanceof Error?n:(e=a.parseNumber(e),e instanceof Error?e:(t=a.parseNumber(t),t instanceof Error?t:t*r*(n/e-1))))},n.MDURATION=function(){throw new Error("MDURATION is not implemented")},n.MIRR=function(r,e,t){if(r=a.parseNumbers(u.flatten(r)),r instanceof Error)return r;if(e=a.parseNumber(e),e instanceof Error)return e;if(t=a.parseNumber(t),t instanceof Error)return t;for(var o=r.length,i=[],f=[],s=0;s<o;s++)r[s]<0?i.push(r[s]):f.push(r[s]);var c=-n.NPV(t,f)*Math.pow(1+t,o-1),l=n.NPV(e,i)*(1+e);return Math.pow(c/l,1/(o-1))-1},n.NOMINAL=function(r,n){return r=a.parseNumber(r),r instanceof Error?r:(n=a.parseNumber(n),n instanceof Error?n:r<=0||n<1?t.num:(n=parseInt(n,10),(Math.pow(r+1,1/n)-1)*n))},n.NPER=function(r,n,e,t,o){if(o=void 0===o?0:o,t=void 0===t?0:t,r=a.parseNumber(r),r instanceof Error)return r;if(n=a.parseNumber(n),n instanceof Error)return n;if(e=a.parseNumber(e),e instanceof Error)return e;if(t=a.parseNumber(t),t instanceof Error)return t;if(o=a.parseNumber(o),o instanceof Error)return o;var u=n*(1+r*o)-t*r,i=e*r+n*(1+r*o);return Math.log(u/i)/Math.log(1+r)},n.NPV=function(r){if(r=a.parseNumber(r),r instanceof Error)return r;for(var n=a.parseNumbers(u.flatten(arguments)),e=0,t=1;t<n.length;t++)e+=n[t]/Math.pow(1+r,t);return e},n.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},n.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},n.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},n.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},n.PDURATION=function(r,n,e){return r=a.parseNumber(r),r instanceof Error?r:(n=a.parseNumber(n),n instanceof Error?n:(e=a.parseNumber(e),e instanceof Error?e:r<=0?t.num:(Math.log(e)-Math.log(n))/Math.log(1+r)))},n.PMT=function(r,n,e,t,o){if(t=t||0,o=o||0,r=a.parseNumber(r),r instanceof Error)return r;if(n=a.parseNumber(n),n instanceof Error)return n;if(e=a.parseNumber(e),e instanceof Error)return e;if(t=a.parseNumber(t),t instanceof Error)return t;if(o=a.parseNumber(o),o instanceof Error)return o;var u;if(0===r)u=(e+t)/n;else{var i=Math.pow(1+r,n);u=1===o?(t*r/(i-1)+e*r/(1-1/i))/(1+r):t*r/(i-1)+e*r/(1-1/i)}return-u},n.PPMT=function(r,e,t,o,u,i){return u=u||0,i=i||0,r=a.parseNumber(r),r instanceof Error?r:(t=a.parseNumber(t),t instanceof Error?t:(o=a.parseNumber(o),o instanceof Error?o:(u=a.parseNumber(u),u instanceof Error?u:(i=a.parseNumber(i),i instanceof Error?i:n.PMT(r,t,o,u,i)-n.IPMT(r,e,t,o,u,i)))))},n.PRICE=function(){throw new Error("PRICE is not implemented")},n.PRICEDISC=function(){throw new Error("PRICEDISC is not implemented")},n.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},n.PV=function(r,n,e,t,o){return t=t||0,o=o||0,r=a.parseNumber(r),r instanceof Error?r:(n=a.parseNumber(n),n instanceof Error?n:(e=a.parseNumber(e),e instanceof Error?e:(t=a.parseNumber(t),t instanceof Error?t:(o=a.parseNumber(o),o instanceof Error?o:0===r?-e*n-t:((1-Math.pow(1+r,n))/r*e*(1+r*o)-t)/Math.pow(1+r,n)))))},n.RATE=function(r,n,e,t,o,u){if(u=void 0===u?.01:u,t=void 0===t?0:t,o=void 0===o?0:o,r=a.parseNumber(r),r instanceof Error)return r;if(n=a.parseNumber(n),n instanceof Error)return n;if(e=a.parseNumber(e),e instanceof Error)return e;if(t=a.parseNumber(t),t instanceof Error)return t;if(o=a.parseNumber(o),o instanceof Error)return o;if(u=a.parseNumber(u),u instanceof Error)return u;var i,f,s,c,l=1e-10,m=50,p=0,h=0,E=0,v=u;for(Math.abs(v)<l?i=e*(1+r*v)+n*(1+v*o)*r+t:(h=Math.exp(r*Math.log(1+v)),i=e*h+n*(1/v+o)*(h-1)+t),f=e+n*r+t,s=e*h+n*(1/v+o)*(h-1)+t,E=c=0,p=v;Math.abs(f-s)>l&&E<m;)v=(s*c-f*p)/(s-f),c=p,p=v,Math.abs(v)<l?i=e*(1+r*v)+n*(1+v*o)*r+t:(h=Math.exp(r*Math.log(1+v)),i=e*h+n*(1/v+o)*(h-1)+t),f=s,s=i,++E;return v},n.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},n.RRI=function(r,n,e){return r=a.parseNumber(r),r instanceof Error?r:(n=a.parseNumber(n),n instanceof Error?n:(e=a.parseNumber(e),e instanceof Error?e:0===r||0===n?t.num:Math.pow(e/n,1/r)-1))},n.SLN=function(r,n,e){return r=a.parseNumber(r),r instanceof Error?r:(n=a.parseNumber(n),n instanceof Error?n:(e=a.parseNumber(e),e instanceof Error?e:0===e?t.num:(r-n)/e))},n.SYD=function(r,n,e,o){return r=a.parseNumber(r),r instanceof Error?r:(n=a.parseNumber(n),n instanceof Error?n:(e=a.parseNumber(e),e instanceof Error?e:(o=a.parseNumber(o),o instanceof Error?o:0===e?t.num:o<1||o>e?t.num:(o=parseInt(o,10),(r-n)*(e-o+1)*2/(e*(e+1))))))},n.TBILLEQ=function(r,n,e){return r=a.parseDate(r),r instanceof Error?r:(n=a.parseDate(n),n instanceof Error?n:(e=a.parseNumber(e),e instanceof Error?e:e<=0?t.num:r>n?t.num:n-r>31536e6?t.num:365*e/(360-e*o.DAYS360(r,n,!1))))},n.TBILLPRICE=function(r,n,e){return r=a.parseDate(r),r instanceof Error?r:(n=a.parseDate(n),n instanceof Error?n:(e=a.parseNumber(e),e instanceof Error?e:e<=0?t.num:r>n?t.num:n-r>31536e6?t.num:100*(1-e*o.DAYS360(r,n,!1)/360)))},n.TBILLYIELD=function(r,n,e){return r=a.parseDate(r),r instanceof Error?r:(n=a.parseDate(n),n instanceof Error?n:(e=a.parseNumber(e),e instanceof Error?e:e<=0?t.num:r>n?t.num:n-r>31536e6?t.num:360*(100-e)/(e*o.DAYS360(r,n,!1))))},n.VDB=function(){throw new Error("VDB is not implemented")},n.XIRR=function(r,n,e){if(r=a.parseNumbers(u.flatten(r)),r instanceof Error)return r;if(n=a.parseDates(u.flatten(n)),n instanceof Error)return n;if(e=a.parseNumber(e),e instanceof Error)return e;for(var i=function(r,n,e){for(var t=e+1,a=r[0],u=1;u<r.length;u++)a+=r[u]/Math.pow(t,o.DAYS(n[u],n[0])/365);return a},f=function(r,n,e){for(var t=e+1,a=0,u=1;u<r.length;u++){var i=o.DAYS(n[u],n[0])/365;a-=i*r[u]/Math.pow(t,i+1)}return a},s=!1,c=!1,l=0;l<r.length;l++)r[l]>0&&(s=!0),r[l]<0&&(c=!0);if(!s||!c)return t.num;e=e||.1;var m,p,h,E=e,v=1e-10,g=!0;do h=i(r,n,E),m=E-h/f(r,n,E),p=Math.abs(m-E),E=m,g=p>v&&Math.abs(h)>v;while(g);return E},n.XNPV=function(r,n,e){if(r=a.parseNumber(r),r instanceof Error)return r;if(n=a.parseNumbers(u.flatten(n)),n instanceof Error)return n;if(e=a.parseDates(u.flatten(e)),e instanceof Error)return e;for(var t=0,i=0;i<n.length;i++)t+=n[i]/Math.pow(1+r,o.DAYS(e[i],e[0])/365);return t},n.YIELD=function(){throw new Error("YIELD is not implemented")},n.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},n.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")}},function(r,n,e){var t=e(6),o=e(4),a=e(5);n.CHOOSE=function(r){if(r=o.parseNumber(r),r instanceof Error)return r;if(r<1)return a.value;r=Math.floor(r);var n=arguments[r];return void 0===n?a.value:n},n.HLOOKUP=function(r,e,t,u){if(void 0!==u&&null!==u||(u=!0),r instanceof Error)return r;if(e instanceof Error)return e;if(!(e instanceof Array))return a.na;if(e[0]instanceof Array||(e=[e]),t=o.parseNumber(t),t instanceof Error)return t;if(t<1)return a.value;if(t-1>=e[0].length)return a.ref;if(u=o.parseBool(u),u instanceof Error)return u;for(var i=[],f=0;f<e.length;f++)i[f]=e[f][0];var s=n.MATCH(r,i,u?1:0);return s instanceof Error?s:e[s-1][t-1]},n.INDEX=function(r,n,e){if(e=void 0===e?0:e,n=o.parseNumber(n),n instanceof Error)return n;if(e=o.parseNumber(e),e instanceof Error)return e;var t=0===n,u=0===e;if(n--,e--,r[0]instanceof Array||(r=[r]),!r instanceof Array&&(r=[r]),!u&&e>r.length-1)return a.ref;if(!t&&n>r[0].length-1)return a.ref;var i;if(t&&!u)i=r[e];else if(u&&!t){for(var f=[],s=0;s<r.length;s++)f.push([r[s][n]]);i=f}else i=u||t?r:r[e][n];return 1===i.length&&(i=i.pop()),1===i.length&&(i=i.pop()),i},n.MATCH=function(r,n,e){if(r instanceof Error)return r;if(n instanceof Error)return n;if(n instanceof Array||(n=[n]),n[0]instanceof Array&&n[0].length>1)return a.na;if(n=t.flatten(n),void 0!==e&&null!==e||(e=1),e=o.parseNumber(e),e instanceof Error)return a.ref;if(e>1?e=1:e<-1&&(e=-1),e!==-1&&0!==e&&1!==e)return a.na;for(var u=a.na,i=0;i<n.length;i++)if(typeof r==typeof n[i]){if(r===n[i]){u=i+1;break}if(1===e){if(!(n[i]<r))break;u=i+1}else if(e===-1){if(!(n[i]>r))break;u=i+1}else if(0===e&&"string"==typeof r&&n[i].match(new RegExp(r.replace(/[.+^${}()|[\]\\]/g,"\\$&").replace(/\?/g,".").replace(/\*/g,".*?"),"i"))){u=i+1;break}}return u},n.TRANSPOSE=function(r){r[0]instanceof Array||(r=[r]);var n=r.length?r.length:0,e=r[0].length;if(0===e||0===n)return[];var t,o,a=[];for(t=0;t<e;t++)for(a[t]=[],o=0;o<n;o++)a[t][o]=r[o][t];return 1==a.length&&(a=a[0]),a},n.VLOOKUP=function(r,e,t,u){if(void 0!==u&&null!==u||(u=!0),r instanceof Error)return r;if(e instanceof Error)return e;if(!(e instanceof Array))return a.na;if(e[0]instanceof Array||(e=[e]),t=o.parseNumber(t),t instanceof Error)return t;if(t<1)return a.value;if(t-1>=e.length)return a.ref;if(u=o.parseBool(u),u instanceof Error)return u;for(var i=[],f=0;f<e[0].length;f++)i[f]=e[0][f];var s=n.MATCH(r,i,u?1:0);return s instanceof Error?s:e[t-1][s-1]}},14]))});